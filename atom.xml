<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Will Xiao</title>
  
  <subtitle>åˆ†äº«æ˜¯æœ€å¥½çš„å­¦ä¹ </subtitle>
  <link href="/blog/atom.xml" rel="self"/>
  
  <link href="https://willxiao90.github.io/"/>
  <updated>2024-07-21T02:38:05.765Z</updated>
  <id>https://willxiao90.github.io/</id>
  
  <author>
    <name>Will Xiao</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å‘½ä»¤æ¨¡å¼å®ç° undo &amp; redo</title>
    <link href="https://willxiao90.github.io/2024/07/20/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E7%8E%B0%20undo%20&amp;%20redo/"/>
    <id>https://willxiao90.github.io/2024/07/20/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E7%8E%B0%20undo%20&amp;%20redo/</id>
    <published>2024-07-20T20:14:15.000Z</published>
    <updated>2024-07-21T02:38:05.765Z</updated>
    
    <content type="html"><![CDATA[<p>å‰ç«¯ undo &amp; redo åŠŸèƒ½æ˜¯éå¸¸å¸¸è§çš„ï¼Œé€šå¸¸ä¼šä½¿ç”¨å‘½ä»¤æ¨¡å¼æ¥å®ç°ã€‚</p><p>ä¸‹é¢ä»¥ä¸€ä¸ªä½ä»£ç ç¼–è¾‘å™¨çš„ä¾‹å­ï¼Œæ¥ä»‹ç» JavaScript æ˜¯å¦‚ä½•ä½¿ç”¨å‘½ä»¤æ¨¡å¼æ¥å®ç° undo &amp; redo åŠŸèƒ½çš„ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å‘½ä»¤æ¨¡å¼çš„ç»“æ„ç¤ºæ„å›¾ã€‚</p><p><img src="/blog/images/cc2f4b0283e74a8fa5cdaeb85c2837d1.png" alt="alt text"></p><p>åœ¨å‘½ä»¤æ¨¡å¼ä¸­ï¼Œå…³é”®æ˜¯å®šä¹‰äº†ä¸€ä¸ª Command æ¥å£ï¼Œå®ƒæœ‰ execute å’Œ undo ä¸¤ä¸ªæ–¹æ³•ï¼Œå…·ä½“çš„å‘½ä»¤ç±»éƒ½éœ€è¦å®ç°è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚è°ƒç”¨è€…ï¼ˆInvokerï¼‰åœ¨è°ƒç”¨å‘½ä»¤çš„æ—¶å€™ï¼Œåªéœ€è¦æ‰§è¡Œå‘½ä»¤å¯¹è±¡çš„ execute å’Œ undo æ–¹æ³•å³å¯ï¼Œè€Œä¸ç”¨å…³å¿ƒè¿™ä¸¤ä¸ªæ–¹æ³•å…·ä½“åšäº†ä»€ä¹ˆã€‚å®é™…ä¸Šè¿™ä¸¤æ–¹æ³•çš„å…·ä½“å®ç°ï¼Œé€šå¸¸éƒ½æ˜¯åœ¨æ¥æ”¶è€…ï¼ˆReceiverï¼‰ä¸­ï¼Œå‘½ä»¤ç±»ä¸­é€šå¸¸æœ‰ä¸€ä¸ªæ¥æ”¶è€…å®ä¾‹ï¼Œå‘½ä»¤ç±»åªéœ€è¦è°ƒç”¨æ¥æ”¶è€…å®ä¾‹æ–¹æ³•å³å¯ã€‚</p><p>OKï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„ä½ä»£ç ç¼–è¾‘å™¨çš„çŠ¶æ€åº“ï¼ˆç®€åŒ–ç‰ˆçš„ï¼‰ã€‚å®ƒæ˜¯ä½¿ç”¨ zustand å®šä¹‰çš„ï¼Œå®ƒæœ‰ä¸€ä¸ªç»„ä»¶åˆ—è¡¨ componentListï¼Œä»¥åŠç›¸å…³çš„3ä¸ªæ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">"zustand/vanilla"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = createStore(<span class="function">(<span class="params">set</span>) =&gt;</span> (&#123;</span><br><span class="line">  componentList: [], <span class="comment">// ç»„ä»¶åˆ—è¡¨</span></span><br><span class="line">  <span class="comment">// æ·»åŠ ç»„ä»¶</span></span><br><span class="line">  addComponent: <span class="function">(<span class="params">comp</span>) =&gt;</span></span><br><span class="line">    <span class="keyword">set</span>((state) =&gt; (&#123; componentList: [...state.componentList, comp] &#125;)),</span><br><span class="line">  <span class="comment">// åˆ é™¤ç»„ä»¶</span></span><br><span class="line">  removeComponent: <span class="function">(<span class="params">comp</span>) =&gt;</span></span><br><span class="line">    <span class="keyword">set</span>((state) =&gt; (&#123;</span><br><span class="line">      componentList: state.componentList.filter(<span class="function">(<span class="params">v</span>) =&gt;</span> v.id !== comp.id),</span><br><span class="line">    &#125;)),</span><br><span class="line">  <span class="comment">// æ›´æ–°ç»„ä»¶å±æ€§</span></span><br><span class="line">  updateComponentProps: <span class="function">(<span class="params">comp, newProps</span>) =&gt;</span></span><br><span class="line">    <span class="keyword">set</span>((state) =&gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> index = state.componentList.findIndex(<span class="function">(<span class="params">v</span>) =&gt;</span> v.id === comp.id);</span><br><span class="line">      <span class="keyword">if</span> (index &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> list = [...state.componentList];</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          componentList: [</span><br><span class="line">            ...list.slice(<span class="number">0</span>, index),</span><br><span class="line">            &#123; ...comp, <span class="attr">props</span>: newProps &#125;,</span><br><span class="line">            ...list.slice(index + <span class="number">1</span>),</span><br><span class="line">          ],</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">&#125;));</span><br><span class="line"><span class="comment">// const &#123; getState, setState, subscribe, getInitialState &#125; = store;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ç›¸å…³å‘½ä»¤ç±»çš„å®ç°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘½ä»¤åŸºç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;&#125;</span><br><span class="line"></span><br><span class="line">  execute() &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"æœªé‡å†™ execute æ–¹æ³•ï¼"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  undo() &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"æœªé‡å†™ undo æ–¹æ³•ï¼"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AddComponentCommand</span> <span class="keyword">extends</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">  editorStore; <span class="comment">// çŠ¶æ€åº“ï¼ˆå®ƒå……å½“ Receiverï¼‰</span></span><br><span class="line">  comp;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>(editorStore, comp) &#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    <span class="keyword">this</span>.editorStore = editorStore;</span><br><span class="line">    <span class="keyword">this</span>.comp = comp;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  execute(comp) &#123;</span><br><span class="line">    <span class="keyword">this</span>.editorStore.getState().addComponent(<span class="keyword">this</span>.comp);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  undo() &#123;</span><br><span class="line">    <span class="keyword">this</span>.editorStore.getState().removeComponent(<span class="keyword">this</span>.comp);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">RemoveComponentCommand</span> <span class="keyword">extends</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">  editorStore;</span><br><span class="line">  comp;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>(editorStore, comp) &#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    <span class="keyword">this</span>.editorStore = editorStore;</span><br><span class="line">    <span class="keyword">this</span>.comp = comp;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  execute() &#123;</span><br><span class="line">    <span class="keyword">this</span>.editorStore.getState().removeComponent(<span class="keyword">this</span>.comp);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  undo() &#123;</span><br><span class="line">    <span class="keyword">this</span>.editorStore.getState().addComponent(<span class="keyword">this</span>.comp);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UpdateComponentPropsCommand</span> <span class="keyword">extends</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">  editorStore;</span><br><span class="line">  comp;</span><br><span class="line">  newProps;</span><br><span class="line">  prevProps; <span class="comment">// ä¿å­˜ä¹‹å‰çš„å±æ€§</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>(editorStore, comp, newProps) &#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    <span class="keyword">this</span>.editorStore = editorStore;</span><br><span class="line">    <span class="keyword">this</span>.comp = comp;</span><br><span class="line">    <span class="keyword">this</span>.newProps = newProps;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  execute() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; updateComponentProps, componentList &#125; = <span class="keyword">this</span>.editorStore.getState();</span><br><span class="line">    <span class="keyword">this</span>.prevProps = componentList.find(<span class="function">(<span class="params">v</span>) =&gt;</span> v.id === <span class="keyword">this</span>.comp.id)?.props;</span><br><span class="line">    updateComponentProps(<span class="keyword">this</span>.comp, <span class="keyword">this</span>.newProps);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  undo() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; updateComponentProps &#125; = <span class="keyword">this</span>.editorStore.getState();</span><br><span class="line">    updateComponentProps(<span class="keyword">this</span>.comp, <span class="keyword">this</span>.prevProps);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å®ç°äº† AddComponentCommandã€RemoveComponentCommand å’Œ UpdateComponentPropsCommand 3ä¸ªå‘½ä»¤ç±»ï¼Œåœ¨æˆ‘ä»¬çš„å‘½ä»¤ç±»ä¸­éƒ½æœ‰ä¸€ä¸ª editorStore å±æ€§ï¼Œå®ƒåœ¨è¿™é‡Œå……å½“äº† Receiver æ¥æ”¶è€…ï¼Œå› ä¸ºç¼–è¾‘å™¨ç›¸å…³æ“ä½œæˆ‘ä»¬éƒ½å®šä¹‰åœ¨çŠ¶æ€åº“ä¸­ã€‚</p><p>å…¶ä¸­ AddComponentCommand å’Œ RemoveComponentCommand ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œæœ‰ç›´æ¥çš„æ“ä½œå¯ä»¥å®ç°æ’¤é”€ã€‚UpdateComponentPropsCommand å°±ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œæˆ‘ä»¬æ›´æ–°äº†å±æ€§ä¹‹åï¼Œæ²¡æœ‰ä¸€ä¸ªç›´æ¥çš„æ“ä½œå¯ä»¥æ’¤é”€ä¿®æ”¹ï¼Œè¿™ç§æƒ…å†µæˆ‘ä»¬é€šå¸¸éœ€è¦å¢åŠ ä¸€ä¸ªå±æ€§ï¼Œè®°å½•ä¿®æ”¹ä¹‹å‰çš„çŠ¶æ€ï¼Œç”¨äºå®ç°æ’¤é”€åŠŸèƒ½ï¼Œåœ¨ UpdateComponentPropsCommand ä¸­å°±æ˜¯ prevPropsã€‚</p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„å‘½ä»¤ç±»éƒ½å·²ç»å®ç°äº†ï¼Œè¦å®ç° undo å’Œ redo åŠŸèƒ½ï¼Œé€šå¸¸æˆ‘ä»¬è¿˜éœ€è¦å®ç°ä¸€ä¸ªå‘½ä»¤ç®¡ç†ç±»ï¼Œå®ƒéœ€è¦å®ç° executeã€undo å’Œ redo ä¸‰ä¸ªæ–¹æ³•ã€‚å®ƒçš„å…·ä½“å®ç°å¤šç§æ–¹æ³•ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨ä¸¤ä¸ªæ ˆï¼ˆStackï¼‰æ¥å®ç°ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommandManager</span> </span>&#123;</span><br><span class="line">  undoStack = []; <span class="comment">// æ’¤é”€æ ˆ</span></span><br><span class="line">  redoStack = []; <span class="comment">// é‡åšæ ˆ</span></span><br><span class="line"></span><br><span class="line">  execute(command) &#123;</span><br><span class="line">    command.execute();</span><br><span class="line">    <span class="keyword">this</span>.undoStack.push(command);</span><br><span class="line">    <span class="keyword">this</span>.redoStack = [];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  undo() &#123;</span><br><span class="line">    <span class="keyword">const</span> command = <span class="keyword">this</span>.undoStack.pop();</span><br><span class="line">    <span class="keyword">if</span> (command) &#123;</span><br><span class="line">      command.undo();</span><br><span class="line">      <span class="keyword">this</span>.redoStack.push(command);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  redo() &#123;</span><br><span class="line">    <span class="keyword">const</span> command = <span class="keyword">this</span>.redoStack.pop();</span><br><span class="line">    <span class="keyword">if</span> (command) &#123;</span><br><span class="line">      command.execute();</span><br><span class="line">      <span class="keyword">this</span>.undoStack.push(command);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> CommandManager();</span><br></pre></td></tr></table></figure><p>æœ‰äº†è¿™äº›ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥è¿›å…¥æµ‹è¯•ç¯èŠ‚äº†ï¼Œä¸‹é¢æ˜¯æˆ‘ä»¬çš„æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">"./store/editorStore"</span>;</span><br><span class="line"><span class="keyword">import</span> cmdManager <span class="keyword">from</span> <span class="string">"./commands/cmdManager"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®æ—¶æ‰“å°ç»„ä»¶åˆ—è¡¨</span></span><br><span class="line">store.subscribe(<span class="function">(<span class="params">state</span>) =&gt;</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(state.componentList))</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> comp1 = &#123;</span><br><span class="line">  id: <span class="number">101</span>,</span><br><span class="line">  componentName: <span class="string">"Comp1"</span>,</span><br><span class="line">  props: &#123;&#125;,</span><br><span class="line">  children: <span class="literal">null</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> comp2 = &#123;</span><br><span class="line">  id: <span class="number">102</span>,</span><br><span class="line">  componentName: <span class="string">"Comp2"</span>,</span><br><span class="line">  props: &#123;&#125;,</span><br><span class="line">  children: <span class="literal">null</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">cmdManager.execute(<span class="keyword">new</span> AddComponentCommand(store, comp1));</span><br><span class="line">cmdManager.execute(<span class="keyword">new</span> AddComponentCommand(store, comp2));</span><br><span class="line">cmdManager.undo();</span><br><span class="line">cmdManager.redo();</span><br><span class="line"></span><br><span class="line">cmdManager.execute(<span class="keyword">new</span> RemoveComponentCommand(store, comp1));</span><br><span class="line">cmdManager.undo();</span><br><span class="line"></span><br><span class="line">cmdManager.execute(</span><br><span class="line">  <span class="keyword">new</span> UpdateComponentPropsCommand(store, comp1, &#123; <span class="attr">visible</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">);</span><br><span class="line">cmdManager.undo();</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼Œè¯´æ˜æˆ‘ä»¬çš„ä»£ç æ­£å¸¸å·¥ä½œäº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// [&#123;"id":101,"componentName":"Comp1","props":&#123;&#125;,"children":null&#125;]</span></span><br><span class="line"><span class="comment">// [&#123;"id":101,"componentName":"Comp1","props":&#123;&#125;,"children":null&#125;,&#123;"id":102,"componentName":"Comp2","props":&#123;&#125;,"children":null&#125;]</span></span><br><span class="line"><span class="comment">// [&#123;"id":101,"componentName":"Comp1","props":&#123;&#125;,"children":null&#125;]</span></span><br><span class="line"><span class="comment">// [&#123;"id":101,"componentName":"Comp1","props":&#123;&#125;,"children":null&#125;,&#123;"id":102,"componentName":"Comp2","props":&#123;&#125;,"children":null&#125;]</span></span><br><span class="line"><span class="comment">// [&#123;"id":102,"componentName":"Comp2","props":&#123;&#125;,"children":null&#125;]</span></span><br><span class="line"><span class="comment">// [&#123;"id":102,"componentName":"Comp2","props":&#123;&#125;,"children":null&#125;,&#123;"id":101,"componentName":"Comp1","props":&#123;&#125;,"children":null&#125;]</span></span><br><span class="line"><span class="comment">// [&#123;"id":102,"componentName":"Comp2","props":&#123;&#125;,"children":null&#125;,&#123;"id":101,"componentName":"Comp1","props":&#123;"visible":true&#125;,"children":null&#125;]</span></span><br><span class="line"><span class="comment">// [&#123;"id":102,"componentName":"Comp2","props":&#123;&#125;,"children":null&#125;,&#123;"id":101,"componentName":"Comp1","props":&#123;&#125;,"children":null&#125;]</span></span><br></pre></td></tr></table></figure><p>&#x20;è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†å®Œæ•´çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬äº†ã€‚ä½†æ˜¯ä»£ç è¿˜æœ‰ä¼˜åŒ–çš„ç©ºé—´ï¼Œæˆ‘ä»¬ç»§ç»­æ”¹è¿›ä¸€ä¸‹ã€‚</p><p>ç¬¬ä¸€ç‚¹ï¼Œæ‰§è¡Œå‘½ä»¤çš„åœ°æ–¹ï¼Œè¦æ‰‹åŠ¨ new å‘½ä»¤ç±»ï¼Œä¼ å…¥ store çŠ¶æ€åº“ï¼Œæœ‰è¾ƒå¤šçš„æ¨¡æ¿ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cmdManager.execute(<span class="keyword">new</span> AddComponentCommand(store, comp1));</span><br><span class="line">cmdManager.execute(<span class="keyword">new</span> AddComponentCommand(store, comp2));</span><br><span class="line">cmdManager.undo();</span><br><span class="line">cmdManager.redo();</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥å‚è€ƒ js åŸç”Ÿæ–¹æ³• <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Document/execCommand" target="_blank" rel="noopener">document.execCommand</a> å®ç°ä¸€ä¸ª executeCommand () æ–¹æ³•ï¼Œè¿™æ ·æ‰§è¡Œå‘½ä»¤å°±å˜æˆäº† executeCommand(commandName, â€¦args) è¿™æ ·ï¼Œæ›´ä¸ºæ–¹ä¾¿ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cmdManager <span class="keyword">from</span> <span class="string">"./cmdManager"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  AddComponentCommand,</span><br><span class="line">  RemoveComponentCommand,</span><br><span class="line">  UpdateComponentPropsCommand,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">"./index"</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">"../store/editorStore"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> commondActions = &#123;</span><br><span class="line">  addComponent(...args) &#123;</span><br><span class="line">    <span class="keyword">const</span> cmd = <span class="keyword">new</span> AddComponentCommand(store, ...args);</span><br><span class="line">    cmdManager.execute(cmd);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  removeComponent(...args) &#123;</span><br><span class="line">    <span class="keyword">const</span> cmd = <span class="keyword">new</span> RemoveComponentCommand(store, ...args);</span><br><span class="line">    cmdManager.execute(cmd);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  updateComponentProps(...args) &#123;</span><br><span class="line">    <span class="keyword">const</span> cmd = <span class="keyword">new</span> UpdateComponentPropsCommand(store, ...args);</span><br><span class="line">    cmdManager.execute(cmd);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  undo() &#123;</span><br><span class="line">    cmdManager.undo();</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  redo() &#123;</span><br><span class="line">    cmdManager.redo();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> executeCommand = <span class="function">(<span class="params">cmdName, ...args</span>) =&gt;</span> &#123;</span><br><span class="line">  commondActions[cmdName](...args);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> executeCommand;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">store.subscribe(<span class="function">(<span class="params">state</span>) =&gt;</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(state.componentList))</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> comp1 = &#123;</span><br><span class="line">  id: <span class="number">101</span>,</span><br><span class="line">  componentName: <span class="string">"Comp1"</span>,</span><br><span class="line">  props: &#123;&#125;,</span><br><span class="line">  children: <span class="literal">null</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> comp2 = &#123;</span><br><span class="line">  id: <span class="number">102</span>,</span><br><span class="line">  componentName: <span class="string">"Comp2"</span>,</span><br><span class="line">  props: &#123;&#125;,</span><br><span class="line">  children: <span class="literal">null</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">executeCommand(<span class="string">"addComponent"</span>, comp1);</span><br><span class="line">executeCommand(<span class="string">"addComponent"</span>, comp2);</span><br><span class="line">executeCommand(<span class="string">"undo"</span>);</span><br><span class="line">executeCommand(<span class="string">"redo"</span>);</span><br><span class="line"></span><br><span class="line">executeCommand(<span class="string">"removeComponent"</span>, comp1);</span><br><span class="line">executeCommand(<span class="string">"undo"</span>);</span><br><span class="line"></span><br><span class="line">executeCommand(<span class="string">"updateComponentProps"</span>, comp1, &#123; <span class="attr">visible</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">executeCommand(<span class="string">"undo"</span>);</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç‚¹ï¼ŒCommandManager å…¶å®ä½¿ç”¨ä¸€ä¸ªæ ˆï¼ˆStackï¼‰åŠ ä¸ŠæŒ‡é’ˆä¹Ÿå¯ä»¥å®ç°ï¼Œæˆ‘ä»¬å‚è€ƒäº†ç½‘ä¸Šçš„ä»£ç ï¼ˆ<a href="https://developer.s24.com/blog/js-command-pattern-for-undo-and-redo.html" target="_blank" rel="noopener">JavaScript command pattern for undo and redo</a>ï¼‰ï¼Œä¼˜åŒ–ä¹‹åä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommandManager</span> </span>&#123;</span><br><span class="line">  _commandsList = [];</span><br><span class="line">  _currentCommand = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">  execute(command) &#123;</span><br><span class="line">    command.execute();</span><br><span class="line">    <span class="keyword">this</span>._currentCommand++;</span><br><span class="line">    <span class="keyword">this</span>._commandsList[<span class="keyword">this</span>._currentCommand] = command;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>._commandsList[<span class="keyword">this</span>._currentCommand + <span class="number">1</span>]) &#123;</span><br><span class="line">      <span class="keyword">this</span>._commandsList.splice(<span class="keyword">this</span>._currentCommand + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  undo() &#123;</span><br><span class="line">    <span class="keyword">const</span> command = <span class="keyword">this</span>._commandsList[<span class="keyword">this</span>._currentCommand];</span><br><span class="line">    <span class="keyword">if</span> (command) &#123;</span><br><span class="line">      command.undo();</span><br><span class="line">      <span class="keyword">this</span>._currentCommand--;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  redo() &#123;</span><br><span class="line">    <span class="keyword">const</span> command = <span class="keyword">this</span>._commandsList[<span class="keyword">this</span>._currentCommand + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (command) &#123;</span><br><span class="line">      command.execute();</span><br><span class="line">      <span class="keyword">this</span>._currentCommand++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> CommandManager();</span><br></pre></td></tr></table></figure><p>OKï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„ç¬¬äºŒä¸ªç‰ˆæœ¬äº†ã€‚</p><p>å‚è€ƒèµ„æ–™ï¼š</p><p>ã€ŠHead First è®¾è®¡æ¨¡å¼ - å‘½ä»¤æ¨¡å¼ã€‹</p><p><a href="https://segmentfault.com/a/1190000018940715" target="_blank" rel="noopener">javascript - åŸºäºWebçš„svgç¼–è¾‘å™¨ï¼ˆ1ï¼‰â€”â€”æ’¤é”€é‡åšåŠŸèƒ½ - ä¸ªäººæ–‡ç«  - SegmentFault æ€å¦</a></p><p><a href="https://developer.s24.com/blog/js-command-pattern-for-undo-and-redo.html" target="_blank" rel="noopener">JavaScript command pattern for undo and redo (s24.com)</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å‰ç«¯ undo &amp;amp; redo åŠŸèƒ½æ˜¯éå¸¸å¸¸è§çš„ï¼Œé€šå¸¸ä¼šä½¿ç”¨å‘½ä»¤æ¨¡å¼æ¥å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢ä»¥ä¸€ä¸ªä½ä»£ç ç¼–è¾‘å™¨çš„ä¾‹å­ï¼Œæ¥ä»‹ç» JavaScript æ˜¯å¦‚ä½•ä½¿ç”¨å‘½ä»¤æ¨¡å¼æ¥å®ç° undo &amp;amp; redo åŠŸèƒ½çš„ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å‘½ä»¤æ¨¡å¼çš„ç»“æ„ç¤º
      
    
    </summary>
    
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://willxiao90.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="å‘½ä»¤æ¨¡å¼" scheme="https://willxiao90.github.io/tags/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>UUID å…¨å±€å”¯ä¸€æ ‡è¯†</title>
    <link href="https://willxiao90.github.io/2024/01/12/UUID%20%E5%85%A8%E5%B1%80%E5%94%AF%E4%B8%80%E6%A0%87%E8%AF%86/"/>
    <id>https://willxiao90.github.io/2024/01/12/UUID%20%E5%85%A8%E5%B1%80%E5%94%AF%E4%B8%80%E6%A0%87%E8%AF%86/</id>
    <published>2024-01-12T21:24:15.000Z</published>
    <updated>2024-07-21T02:38:05.765Z</updated>
    
    <content type="html"><![CDATA[<h2 id="UUID"><a href="#UUID" class="headerlink" title="UUID"></a>UUID</h2><p>UUID é€šç”¨å”¯ä¸€è¯†åˆ«ç ï¼ˆUniversally Unique Identifierï¼‰æ˜¯ç”¨äºè®¡ç®—æœºä½“ç³»ä¸­ä»¥è¯†åˆ«ä¿¡æ¯çš„ä¸€ä¸ª128ä½æ ‡è¯†ç¬¦ã€‚</p><p>UUIDæŒ‰ç…§æ ‡å‡†æ–¹æ³•ç”Ÿæˆæ—¶ï¼Œåœ¨å®é™…åº”ç”¨ä¸­å…·æœ‰å”¯ä¸€æ€§ï¼Œä¸”ä¸ä¾èµ–ä¸­å¤®æœºæ„çš„æ³¨å†Œå’Œåˆ†é…ã€‚UUIDé‡å¤çš„æ¦‚ç‡æ¥è¿‘é›¶ï¼Œå¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</p><p>å› æ­¤ï¼ŒUUID çš„åº”ç”¨éå¸¸æ™®éï¼Œä¾‹å¦‚è¢«ç”¨ä½œåˆ†å¸ƒå¼æ•°æ®åº“è¡¨çš„ä¸»é”®ï¼Œå¾®è½¯çš„GUID(Globals Unique Identifiers)ç­‰ç­‰ã€‚</p><p>åœ¨å…¶è§„èŒƒçš„æ–‡æœ¬è¡¨ç¤ºä¸­ï¼ŒUUID çš„ 16 ä¸ª 8 ä½å­—èŠ‚è¡¨ç¤ºä¸º 32 ä¸ªåå…­è¿›åˆ¶æ•°å­—ï¼Œç”±è¿å­—ç¬¦ â€˜-â€˜ åˆ†éš”æˆäº”ç»„æ˜¾ç¤ºï¼Œå½¢å¼ä¸ºâ€œ8-4-4-4-12â€æ€»å…± 36 ä¸ªå­—ç¬¦ï¼ˆ32 ä¸ªåå…­è¿›åˆ¶æ•°å­—å’Œ 4 ä¸ªè¿å­—ç¬¦ï¼‰ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">123e4567-e89b-12d3-a456-426655440000</span><br><span class="line">00000000-0000-0000-0000-000000000000</span><br></pre></td></tr></table></figure><p>å®ƒæœ‰å¤šä¸ªä¸åŒçš„ç‰ˆæœ¬ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æœ‰v1ã€v3ã€v4ã€v5ï¼š</p><p>ç‰ˆæœ¬1çš„UUIDæ˜¯æ ¹æ®æ—¶é—´å’ŒèŠ‚ç‚¹IDï¼ˆé€šå¸¸æ˜¯MACåœ°å€ï¼‰ç”Ÿæˆï¼›</p><p>ç‰ˆæœ¬3ã€ç‰ˆæœ¬5é€è¿‡å¯¹å‘½åç©ºé—´ï¼ˆnamespaceï¼‰æ ‡è¯†ç¬¦å’Œåç§°è¿›è¡Œæ•£åˆ—ç”Ÿæˆç¡®å®šæ€§çš„UUIDï¼›</p><p>ç‰ˆæœ¬4çš„UUIDåˆ™ä½¿ç”¨éšæœºæ€§æˆ–ä¼ªéšæœºæ€§ç”Ÿæˆã€‚</p><p><img src="/blog/images/image.png" alt="Alt text"></p><p>å®ƒçš„å†²çªæ¦‚ç‡éå¸¸å°ï¼Œä»¥ç‰ˆæœ¬4çš„UUIDä¸ºä¾‹ï¼Œå¦‚æœè¦æœ‰50%çš„å‡ ç‡è‡³å°‘å‘ç”Ÿä¸€æ¬¡å†²çªï¼Œéœ€è¦ç”Ÿæˆè‡³å°‘ 2.71E18 ä¸ªUUIDã€‚è®¡ç®—å¦‚ä¸‹ï¼š</p><p><img src="/blog/images/image-1.png" alt="Alt text"></p><p>è¿™ä¸ªæ•°å­—ç›¸å½“äºæ¯ç§’äº§ç”Ÿ 10 äº¿ä¸ª UUID æŒç»­ 85 å¹´ã€‚</p><p>ç°ä»£çš„æµè§ˆå™¨æä¾›äº† crypto.randomUUID() æ–¹æ³•ï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿çš„ç”Ÿæˆä¸€ä¸ªç‰ˆæœ¬4çš„UUIDã€‚</p><p>æˆ–è€…ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ uuid æ¥ç”Ÿæˆ v1ã€v3ã€v4ã€v5 ç‰ˆæœ¬çš„ UUIDã€‚</p><h2 id="nanoid"><a href="#nanoid" class="headerlink" title="nanoid"></a>nanoid</h2><p>nanoid æ˜¯ UUID çš„æœ‰åŠ›ç«äº‰è€…ï¼Œå®ƒåŒæ ·å¯ä»¥ç”Ÿæˆå”¯ä¸€çš„æ ‡è¯†å­—ç¬¦ä¸²ã€‚</p><p>ä¸ UUID ç›¸æ¯”ï¼Œå®ƒä½¿ç”¨æ›´å¤§çš„å­—æ¯è¡¨ï¼Œè¿™æ ·ä¸€æ¥å®ƒç”Ÿæˆçš„å­—ç¬¦ä¸²é•¿åº¦æ›´çŸ­ï¼Œåªæœ‰21ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸”å®ƒçš„åŒ…ä½“ç§¯åªæœ‰UUIDçš„1/4ã€‚nanoid å¤§æœ‰å–ä»£ UUID çš„è¶‹åŠ¿ã€‚</p><p><img src="/blog/images/image-2.png" alt="Alt text"></p><p>å¦å¤–ï¼Œnanoid å¯ä»¥è‡ªå®šä¹‰å­—æ¯è¡¨å’ŒIDé•¿åº¦ï¼Œè¿™ç»™ç”¨æˆ·æä¾›äº†æ›´å¤šçµæ´»æ€§ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; customAlphabet &#125; <span class="keyword">from</span> <span class="string">'nanoid'</span></span><br><span class="line"><span class="keyword">const</span> nanoid = customAlphabet(<span class="string">'1234567890abcdef'</span>, <span class="number">10</span>)</span><br><span class="line">model.id = nanoid() <span class="comment">//=&gt; "4f90d13a42"</span></span><br></pre></td></tr></table></figure><h2 id="SHA-1"><a href="#SHA-1" class="headerlink" title="SHA-1"></a>SHA-1</h2><p>SHA-1ï¼ˆè‹±è¯­ï¼šSecure Hash Algorithm 1ï¼Œä¸­æ–‡åï¼šå®‰å…¨æ•£åˆ—ç®—æ³•1ï¼‰æ˜¯ä¸€ç§å¯†ç æ•£åˆ—å‡½æ•°ï¼Œç¾å›½å›½å®¶å®‰å…¨å±€è®¾è®¡ï¼Œå¹¶ç”±ç¾å›½å›½å®¶æ ‡å‡†æŠ€æœ¯ç ”ç©¶æ‰€ï¼ˆNISTï¼‰å‘å¸ƒä¸ºè”é‚¦æ•°æ®å¤„ç†æ ‡å‡†ï¼ˆFIPSï¼‰ã€‚SHA-1å¯ä»¥ç”Ÿæˆä¸€ä¸ªè¢«ç§°ä¸ºæ¶ˆæ¯æ‘˜è¦çš„160ä½ï¼ˆ20å­—èŠ‚ï¼‰æ•£åˆ—å€¼ï¼Œæ•£åˆ—å€¼é€šå¸¸çš„å‘ˆç°å½¢å¼ä¸º40ä¸ªåå…­è¿›åˆ¶æ•°ã€‚</p><p>SHA-1 ä¸€ç§å¯†ç æ•£åˆ—å‡½æ•°ï¼Œå¯†ç æ•£åˆ—å‡½æ•°çš„ç‰¹æ€§æ˜¯ï¼Œå¯¹ä»»æ„ä¸€ç»„è¾“å…¥æ•°æ®è¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°ä¸€ä¸ªå›ºå®šé•¿åº¦çš„è¾“å‡ºæ‘˜è¦ã€‚å¦‚æœè¾“å…¥ç›¸åŒä¸€å®šä¼šå¾—åˆ°ç›¸åŒçš„è¾“å‡ºï¼Œå¦‚æœè¾“å…¥ä¸åŒå¤§æ¦‚ç‡ä¼šå¾—åˆ°ä¸åŒçš„è¾“å‡ºã€‚</p><p>å®ƒçš„ä¸»è¦ç›®çš„æ˜¯éªŒè¯åŸå§‹æ•°æ®æ˜¯å¦è¢«ç¯¡æ”¹ã€‚ä¸»è¦åº”ç”¨æœ‰æ–‡ä»¶æ ¡éªŒå’Œï¼ˆcheckSumï¼‰ã€å¯†ç æ–‡æœ¬åŠ å¯†å­˜å‚¨ç­‰ç­‰ã€‚</p><p>å®ƒå…¶å®ä¹Ÿå¯ä»¥ç”¨ä½œå…¨å±€å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå®ƒçš„é•¿åº¦160ä½ï¼Œå†²çªçš„æ¦‚ç‡ä¹Ÿéå¸¸å°ã€‚å› ä¸ºç›¸åŒçš„è¾“å…¥ä¸€å®šä¼šäº§ç”Ÿç›¸åŒçš„è¾“å‡ºï¼Œæ‰€ä»¥å®ƒä½œä¸ºå”¯ä¸€æ ‡è¯†ç¬¦ï¼Œæ˜¯è·Ÿè¾“å…¥å†…å®¹ç›¸å…³çš„ï¼Œéå¸¸é€‚åˆåˆ†å¸ƒå¼å¼€å‘ã€‚å®ƒåœ¨ git ä¸­å°±æœ‰å¤§é‡åº”ç”¨ï¼Œgit ä¸­çš„å¯¹è±¡å”¯ä¸€æ ‡è¯†éƒ½æ˜¯ä½¿ç”¨å®ƒç”Ÿæˆçš„ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;UUID&quot;&gt;&lt;a href=&quot;#UUID&quot; class=&quot;headerlink&quot; title=&quot;UUID&quot;&gt;&lt;/a&gt;UUID&lt;/h2&gt;&lt;p&gt;UUID é€šç”¨å”¯ä¸€è¯†åˆ«ç ï¼ˆUniversally Unique Identifierï¼‰æ˜¯ç”¨äºè®¡ç®—æœºä½“ç³»ä¸­ä»¥è¯†åˆ«ä¿¡æ¯çš„ä¸€ä¸ª12
      
    
    </summary>
    
    
    
      <category term="uuid" scheme="https://willxiao90.github.io/tags/uuid/"/>
    
      <category term="å…¨å±€å”¯ä¸€æ ‡è¯†" scheme="https://willxiao90.github.io/tags/%E5%85%A8%E5%B1%80%E5%94%AF%E4%B8%80%E6%A0%87%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>electron-vue å¼€å‘ç»éªŒæ€»ç»“</title>
    <link href="https://willxiao90.github.io/2020/10/29/electron-vue%20%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/"/>
    <id>https://willxiao90.github.io/2020/10/29/electron-vue%20%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/</id>
    <published>2020-10-29T18:14:15.000Z</published>
    <updated>2024-07-21T02:38:05.765Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æœ€è¿‘å…¬å¸è®©æˆ‘å¼€å‘ä¸€ä¸ªæ¡Œé¢æŠ¥è­¦å™¨ï¼Œä»¥è§£å†³æµè§ˆå™¨é¡µé¢å…³é—­æ— æ³•æ’­æ”¾æŠ¥è­¦å£°éŸ³çš„é—®é¢˜ã€‚</p><p>æ¥åˆ°è¿™ä¸ªé¡¹ç›®ï¼Œè‡ªç„¶çš„é€‰æ‹©äº† <a href="https://simulatedgreg.gitbooks.io/electron-vue/content/cn/" target="_blank" rel="noopener">electron-vue</a> è¿›è¡Œå¼€å‘ï¼ˆæˆ‘ä»¬å…¬å¸ä½¿ç”¨çš„ vueï¼‰</p><p>ç°åœ¨æœ‰æ—¶é—´äº†ï¼Œå¯¹é¡¹ç›®ä¸­é‡åˆ°çš„é—®é¢˜è¿›è¡Œä¸€ä¸ªæ€»ç»“ã€‚</p></blockquote><h2 id="ä¸€ã€é¡¹ç›®æ­å»º-amp-æ‰“åŒ…"><a href="#ä¸€ã€é¡¹ç›®æ­å»º-amp-æ‰“åŒ…" class="headerlink" title="ä¸€ã€é¡¹ç›®æ­å»º &amp; æ‰“åŒ…"></a>ä¸€ã€é¡¹ç›®æ­å»º &amp; æ‰“åŒ…</h2><p>é¡¹ç›®æ­å»ºæ¯”è¾ƒç®€å•ï¼Œç›´æ¥ä½¿ç”¨ electron-vue çš„å®˜æ–¹æ¨¡æ¿å°±å¯ä»¥ç”Ÿæˆé¡¹ç›®ï¼Œéœ€è¦å®‰è£… vue-cli å‘½ä»¤è¡Œå·¥å…·ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install -g vue-cli &#x2F;&#x2F; éœ€è¦å®‰è£… vue-cli è„šæ‰‹æ¶</span><br><span class="line">vue init simulatedgreg&#x2F;electron-vue project-name &#x2F;&#x2F; ä½¿ç”¨ electron-vue å®˜æ–¹æ¨¡æ¿ç”Ÿæˆé¡¹ç›®</span><br><span class="line">npm install &#x2F;&#x2F; å®‰è£…ä¾èµ–</span><br><span class="line">npm run dev &#x2F;&#x2F; å¯åŠ¨é¡¹ç›®</span><br></pre></td></tr></table></figure><p>é¡¹ç›®æ‰“åŒ…ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå¯èƒ½ä¹Ÿæ˜¯å› ä¸ºæˆ‘çš„é¡¹ç›®æœ¬èº«ä¸å¤æ‚å§ã€‚æ™®é€šæ‰“åŒ…æ‰§è¡Œ npm run build å³å¯ï¼Œå¦‚æœè¦æ‰“åŒ…æˆå…å®‰è£…æ–‡ä»¶ï¼Œæ‰§è¡Œ npm run build:dirï¼Œéå¸¸æ–¹ä¾¿ï¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm run build &#x2F;&#x2F; æ‰“åŒ…æˆå¯æ‰§è¡Œæ–‡ä»¶</span><br><span class="line">npm run build:dir &#x2F;&#x2F; æ‰“åŒ…æˆå…å®‰è£…æ–‡ä»¶</span><br></pre></td></tr></table></figure><h2 id="äºŒã€çŠ¶æ€ç®¡ç†"><a href="#äºŒã€çŠ¶æ€ç®¡ç†" class="headerlink" title="äºŒã€çŠ¶æ€ç®¡ç†"></a>äºŒã€çŠ¶æ€ç®¡ç†</h2><p>å› ä¸º electron æ¯ä¸ªç½‘é¡µéƒ½åœ¨è‡ªå·±çš„æ¸²æŸ“è¿›ç¨‹ï¼ˆrenderer processï¼‰ä¸­è¿è¡Œï¼Œæ‰€ä»¥å¦‚æœè¦åœ¨å¤šä¸ªæ¸²æŸ“è¿›ç¨‹é—´å…±äº«çŠ¶æ€ï¼Œå°±ä¸èƒ½ç›´æ¥ä½¿ç”¨ vuex äº†ã€‚</p><p><a href="https://github.com/vue-electron/vuex-electron" target="_blank" rel="noopener">vuex-electron</a> è¿™ä¸ªå¼€æºåº“ä¸ºæˆ‘ä»¬æä¾›äº†ï¼Œåœ¨å¤šä¸ªè¿›ç¨‹é—´å…±äº«çŠ¶æ€çš„æ–¹æ¡ˆï¼ˆåŒ…æ‹¬ä¸»è¿›ç¨‹ï¼‰ã€‚</p><p>å¦‚æœéœ€è¦åœ¨å¤šä¸ªè¿›ç¨‹é—´å…±äº«çŠ¶æ€ï¼Œéœ€è¦ä½¿ç”¨ createSharedMutations ä¸­é—´ä»¶ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store.js æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">"vue"</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">"vuex"</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> &#123; createPersistedState, createSharedMutations &#125; <span class="keyword">from</span> <span class="string">"vuex-electron"</span></span><br><span class="line"> </span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  plugins: [</span><br><span class="line">    createPersistedState(),</span><br><span class="line">    createSharedMutations() <span class="comment">// ç”¨äºå¤šä¸ªè¿›ç¨‹å…±äº«çŠ¶æ€ï¼ŒåŒ…æ‹¬ä¸»è¿›ç¨‹</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å¹¶åœ¨ä¸»è¿›ç¨‹ä¸­å¼•å…¥ store æ–‡ä»¶ã€‚è¿™é‡Œæœ‰ç‚¹å‘ï¼Œæœ€å¼€å§‹çš„æ—¶å€™æˆ‘ä¸çŸ¥é“è¦åœ¨ main.js ä¸­å¼•å…¥ store æ–‡ä»¶ï¼Œç»“æœçŠ¶æ€ä¸€ç›´æ— æ³•æ›´æ–°ï¼Œåˆæ²¡æœ‰ä»»ä½•æŠ¥é”™ï¼Œè°ƒè¯•äº†ä¸€ä¸‹åˆğŸ˜“</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./path/to/your/store'</span> <span class="comment">// éœ€è¦åœ¨ä¸»è¿›ç¨‹å¼•å…¥ store ï¼Œå¦åˆ™çŠ¶æ€æ— æ³•æ›´æ–°</span></span><br></pre></td></tr></table></figure><p>å¦å¤–ï¼Œä½¿ç”¨ createSharedMutations ä¸­é—´ä»¶ï¼Œå¿…é¡»ä½¿ç”¨ dispatch æˆ– mapActions æ›´æ–°çŠ¶æ€ï¼Œä¸èƒ½ä½¿ç”¨ commit ã€‚</p><p>é˜…è¯» vuex-electron çš„æºä»£ç ï¼Œå‘ç°æ¸²æŸ“è¿›ç¨‹å¯¹ dispatch è¿›è¡Œäº†é‡å†™ï¼Œdispatch åªæ˜¯é€šçŸ¥ä¸»è¿›ç¨‹ï¼Œè€Œä¸å®é™…æ›´æ–° storeï¼Œä¸»è¿›ç¨‹æ”¶åˆ° action ä¹‹åï¼Œç«‹å³æ›´æ–°è‡ªå·±çš„ storeï¼Œä¸»è¿›ç¨‹ store æ›´æ–°æˆåŠŸä¹‹åï¼Œä¼šé€šçŸ¥æ‰€æœ‰çš„æ¸²æŸ“è¿›ç¨‹ï¼Œè¿™ä¸ªæ—¶å€™æ¸²æŸ“è¿›ç¨‹æ‰è°ƒç”¨ originalCommit æ›´æ–°è‡ªå·±çš„ storeã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">rendererProcessLogic() &#123;</span><br><span class="line">    <span class="comment">// Connect renderer to main process</span></span><br><span class="line">    <span class="keyword">this</span>.connect()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Save original Vuex methods</span></span><br><span class="line">    <span class="keyword">this</span>.store.originalCommit = <span class="keyword">this</span>.store.commit</span><br><span class="line">    <span class="keyword">this</span>.store.originalDispatch = <span class="keyword">this</span>.store.dispatch</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Don't use commit in renderer outside of actions</span></span><br><span class="line">    <span class="keyword">this</span>.store.commit = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">`[Vuex Electron] Please, don't use direct commit's, use dispatch instead of this.`</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Forward dispatch to main process</span></span><br><span class="line">    <span class="keyword">this</span>.store.dispatch = <span class="function">(<span class="params">type, payload</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// åªæ˜¯é€šçŸ¥ä¸»è¿›ç¨‹ï¼Œæ²¡æœ‰æ›´æ–° store</span></span><br><span class="line">        <span class="keyword">this</span>.notifyMain(&#123; type, payload &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Subscribe on changes from main process and apply them</span></span><br><span class="line">    <span class="keyword">this</span>.onNotifyRenderers(<span class="function">(<span class="params">event, &#123; type, payload &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// æ¸²æŸ“è¿›ç¨‹çœŸæ­£æ›´æ–°è‡ªå·±çš„ store</span></span><br><span class="line">        <span class="keyword">this</span>.store.originalCommit(type, payload)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ... çœç•¥å…¶ä»–ä»£ç </span></span><br><span class="line"></span><br><span class="line">mainProcessLogic() &#123;</span><br><span class="line">    <span class="keyword">const</span> connections = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Save new connection</span></span><br><span class="line">    <span class="keyword">this</span>.onConnect(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> win = event.sender</span><br><span class="line">        <span class="keyword">const</span> winId = win.id</span><br><span class="line"></span><br><span class="line">        connections[winId] = win</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Remove connection when window is closed</span></span><br><span class="line">        win.on(<span class="string">"destroyed"</span>, () =&gt; &#123;</span><br><span class="line">        <span class="keyword">delete</span> connections[winId]</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Subscribe on changes from renderer processes</span></span><br><span class="line">    <span class="keyword">this</span>.onNotifyMain(<span class="function">(<span class="params">event, &#123; type, payload &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// ä¸»è¿›ç¨‹æ›´æ–°äº†è‡ªå·±çš„ store</span></span><br><span class="line">        <span class="keyword">this</span>.store.dispatch(type, payload)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Subscribe on changes from Vuex store</span></span><br><span class="line">    <span class="keyword">this</span>.store.subscribe(<span class="function">(<span class="params">mutation</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; type, payload &#125; = mutation</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¸»è¿›ç¨‹æ›´æ–°æˆåŠŸä¹‹åï¼Œé€šçŸ¥æ‰€æœ‰æ¸²æŸ“è¿›ç¨‹</span></span><br><span class="line">        <span class="keyword">this</span>.notifyRenderers(connections, &#123; type, payload &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œæ¸²æŸ“è¿›ç¨‹çœŸæ­£æ›´æ–° store ç”¨çš„ originalCommit æ–¹æ³•ï¼Œè€Œä¸æ˜¯ originalDispatch æ–¹æ³•ï¼Œå…¶å® originalDispatch åªæ˜¯ä¸ªä»£ç†ï¼Œæ¯ä¸€ä¸ª mutations éƒ½éœ€è¦å†™ä¸€ä¸ªåŒåçš„ actions æ–¹æ³•ï¼Œæ¥æ”¶ç›¸åŒçš„å‚æ•°ï¼Œå¦‚ä¸‹é¢çš„å®˜æ–¹æ ·ä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">"vue"</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">"vuex"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; createPersistedState, createSharedMutations &#125; <span class="keyword">from</span> <span class="string">"vuex-electron"</span></span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    count: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  actions: &#123;</span><br><span class="line">    increment(store) &#123;</span><br><span class="line">      <span class="comment">// æŒ‰ç…§æ¨ç†ï¼Œè¿™é‡Œçš„ commit å…¶å®ä¸èµ·ä½œç”¨ï¼Œä¸æ˜¯å¿…é¡»</span></span><br><span class="line">      <span class="comment">// å…³é”®æ˜¯åç§°ç›¸åŒ</span></span><br><span class="line">      store.commit(<span class="string">"increment"</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    decrement(store) &#123;</span><br><span class="line">      store.commit(<span class="string">"decrement"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  mutations: &#123;</span><br><span class="line">    increment(state) &#123;</span><br><span class="line">      state.count++</span><br><span class="line">    &#125;,</span><br><span class="line">    decrement(state) &#123;</span><br><span class="line">      state.count--</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  plugins: [createPersistedState(), createSharedMutations()],</span><br><span class="line">  strict: process.env.NODE_ENV !== <span class="string">"production"</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>äº‹å®ä¸Šï¼Œå¦‚æœåº”ç”¨å¾ˆç®€å•ï¼Œæ¯”å¦‚æˆ‘çš„é¡¹ç›®åªæœ‰ä¸€ä¸ªçª—å£ï¼Œå°±ä¸å­˜åœ¨å…±äº«çŠ¶æ€çš„é—®é¢˜ï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥ä¸ç”¨ createSharedMutations ä¸­é—´ä»¶ï¼Œä¹Ÿä¸ç”¨åœ¨ main.js ä¸­å¼•å…¥ store æ–‡ä»¶ï¼Œstore æ‰€æœ‰ç”¨æ³•å°±è·Ÿ vuex ä¸€æ ·äº†ã€‚</p><h2 id="ä¸‰ã€æ—¥å¿—"><a href="#ä¸‰ã€æ—¥å¿—" class="headerlink" title="ä¸‰ã€æ—¥å¿—"></a>ä¸‰ã€æ—¥å¿—</h2><p>æ—¥å¿—æˆ‘é‡‡ç”¨çš„æ˜¯ <a href="https://github.com/megahertz/electron-log" target="_blank" rel="noopener">electron-log</a>ï¼Œä¹Ÿå¯ä»¥ç”¨ <a href="https://github.com/log4js-node/log4js-node" target="_blank" rel="noopener">log4js</a></p><p>åœ¨ä¸»è¿›ç¨‹ä¸­ä½¿ç”¨ electron-log å¾ˆç®€å•ï¼Œç›´æ¥å¼•å…¥ï¼Œè°ƒç”¨ info ç­‰æ–¹æ³•å³å¯ã€‚<br>electron-log æä¾›äº† error, warn, info, verbose, debug, silly å…­ç§çº§åˆ«çš„æ—¥å¿—ï¼Œé»˜è®¤éƒ½æ˜¯å¼€å¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> log <span class="keyword">from</span> <span class="string">'electron-log'</span>;</span><br><span class="line"> </span><br><span class="line">log.info(<span class="string">'client å¯åŠ¨æˆåŠŸ'</span>);</span><br><span class="line">log.error(<span class="string">'ä¸»è¿›ç¨‹å‡ºé”™'</span>);</span><br></pre></td></tr></table></figure><p>åœ¨æ¸²æŸ“è¿›ç¨‹ä½¿ç”¨ electron-logï¼Œå¯ä»¥è¦†ç›– console.log ç­‰æ–¹æ³•ï¼Œè¿™æ ·å°±ä¸ç”¨åˆ°å¤„å¼•å…¥ electron-log äº†ï¼Œéœ€è¦å†™æ—¥å¿—çš„åœ°æ–¹ç›´æ¥ä½¿ç”¨ console.log ç­‰æ–¹æ³•å³å¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> log <span class="keyword">from</span> <span class="string">'electron-log'</span>;</span><br><span class="line"> </span><br><span class="line"> <span class="comment">// è¦†ç›– console çš„ logã€errorã€debug ä¸‰ä¸ªæ–¹æ³•</span></span><br><span class="line"><span class="built_in">console</span>.log = log.log;</span><br><span class="line"><span class="built_in">Object</span>.assign(<span class="built_in">console</span>, &#123;</span><br><span class="line">  error: log.error,</span><br><span class="line">  debug: log.debug,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¹‹åï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ console æ”¶é›†æ—¥å¿—</span></span><br><span class="line"><span class="built_in">console</span>.error(<span class="string">'æ¸²æŸ“è¿›ç¨‹å‡ºé”™'</span>)</span><br></pre></td></tr></table></figure><p>electron-log é»˜è®¤ä¼šæ‰“å°åˆ° console æ§åˆ¶å°ï¼Œå¹¶å†™å…¥åˆ°æœ¬åœ°æ–‡ä»¶ï¼Œæœ¬åœ°æ–‡ä»¶è·¯å¾„å¦‚ä¸‹ï¼š</p><ul><li>on Linux: ~/.config/{app name}/logs/{process type}.log</li><li>on macOS: ~/Library/Logs/{app name}/{process type}.log</li><li>on Windows: %USERPROFILE%\AppData\Roaming{app name}\logs{process type}.log</li></ul><hr><p>å¦‚æœä½¿ç”¨ log4js çš„è¯ï¼Œé…ç½®ç›¸å¯¹å¤æ‚ä¸€ç‚¹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æ–‡ä»¶ä¸èƒ½ç›´æ¥å†™åˆ°å½“å‰ç›®å½•ï¼Œè€Œæ˜¯è¦ä½¿ç”¨ app.getPath(â€˜logsâ€™) è·å–åº”ç”¨ç¨‹åºæ—¥å¿—æ–‡ä»¶å¤¹è·¯å¾„ï¼Œå¦åˆ™æ‰“åŒ…ä¹‹åæ— æ³•ç”Ÿæˆæ—¥å¿—æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> log4js <span class="keyword">from</span> <span class="string">'log4js'</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šè¿™é‡Œå¿…é¡»ä½¿ç”¨ app.getPath('logs') è·å–æ—¥å¿—æ–‡ä»¶å¤¹è·¯å¾„</span></span><br><span class="line">log4js.configure(&#123;</span><br><span class="line">  appenders: &#123; <span class="attr">cheese</span>: &#123; <span class="attr">type</span>: <span class="string">'file'</span>, <span class="attr">filename</span>: app.getPath(<span class="string">'logs'</span>) + <span class="string">'/cheese.log'</span> &#125; &#125;,</span><br><span class="line">  categories: &#123; <span class="attr">default</span>: &#123; <span class="attr">appenders</span>: [<span class="string">'cheese'</span>], <span class="attr">level</span>: <span class="string">'error'</span> &#125; &#125;</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> logger = log4js.getLogger(<span class="string">'cheese'</span>)</span><br><span class="line">logger.trace(<span class="string">'Entering cheese testing'</span>)</span><br><span class="line">logger.debug(<span class="string">'Got cheese.'</span>)</span><br><span class="line">logger.info(<span class="string">'Cheese is ComtÃ©.'</span>)</span><br><span class="line">logger.warn(<span class="string">'Cheese is quite smelly.'</span>)</span><br><span class="line">logger.error(<span class="string">'Cheese is too ripe!'</span>)</span><br><span class="line">logger.fatal(<span class="string">'Cheese was breeding ground for listeria.'</span>)</span><br></pre></td></tr></table></figure><h2 id="å››ã€å…¶ä»–é—®é¢˜"><a href="#å››ã€å…¶ä»–é—®é¢˜" class="headerlink" title="å››ã€å…¶ä»–é—®é¢˜"></a>å››ã€å…¶ä»–é—®é¢˜</h2><p>1.ä¿®æ”¹ç³»ç»Ÿæ‰˜ç›˜å›¾æ ‡ï¼Œä¸‹é¢ä»£ç å‚è€ƒäº†ï¼š<a href="https://juejin.im/post/6844903872905871373" target="_blank" rel="noopener">https://juejin.im/post/6844903872905871373</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> tray;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createTray</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> iconUrl = path.join(__static, <span class="string">'/app-icon.png'</span>);</span><br><span class="line">  <span class="keyword">const</span> appIcon = nativeImage.createFromPath(iconUrl);</span><br><span class="line">  tray = <span class="keyword">new</span> Tray(appIcon);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">const</span> contextMenu = Menu.buildFromTemplate([</span><br><span class="line">    &#123;</span><br><span class="line">      label: <span class="string">'æ˜¾ç¤ºä¸»ç•Œé¢'</span>,</span><br><span class="line">      click: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (mainWindow) &#123;</span><br><span class="line">          mainWindow.show();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123; <span class="attr">label</span>: <span class="string">'é€€å‡ºç¨‹åº'</span>, <span class="attr">role</span>: <span class="string">'quit'</span> &#125;,</span><br><span class="line">  ]);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">const</span> appName = app.getName();</span><br><span class="line">  tray.setToolTip(appName);</span><br><span class="line">  tray.setContextMenu(contextMenu);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">let</span> timer;</span><br><span class="line">  <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">  ipcMain.on(<span class="string">'newMessage'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="comment">// å›¾æ ‡é—ªçƒ</span></span><br><span class="line">    timer = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      count += <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> (count % <span class="number">2</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        tray.setImage(appIcon);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªç©ºçš„ nativeImage å®ä¾‹</span></span><br><span class="line">        tray.setImage(nativeImage.createEmpty());</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">500</span>);</span><br><span class="line">      tray.setToolTip(<span class="string">'æ‚¨æœ‰ä¸€æ¡æ–°æ¶ˆæ¯'</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"> </span><br><span class="line">  tray.on(<span class="string">'click'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (mainWindow) &#123;</span><br><span class="line">      mainWindow.show();</span><br><span class="line">      <span class="keyword">if</span> (timer) &#123;</span><br><span class="line">        clearInterval(timer);</span><br><span class="line">        tray.setImage(appIcon);</span><br><span class="line">        tray.setToolTip(appName);</span><br><span class="line">        timer = <span class="literal">undefined</span>;</span><br><span class="line">        count = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.æ’­æ”¾å£°éŸ³</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">audio = <span class="keyword">new</span> Audio(<span class="string">'static/alarm.wav'</span>);</span><br><span class="line">audio.play(); <span class="comment">// å¼€å§‹æ’­æ”¾</span></span><br><span class="line">audio.pause(); <span class="comment">// æš‚åœ</span></span><br></pre></td></tr></table></figure><p>3.æ˜¾ç¤ºé€šçŸ¥æ¶ˆæ¯</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> notify = <span class="keyword">new</span> Notification(<span class="string">'æ ‡é¢˜'</span>, &#123;</span><br><span class="line">   tag: <span class="string">'å”¯ä¸€æ ‡è¯†'</span>, <span class="comment">// ç›¸åŒ tag åªä¼šæ˜¾ç¤ºä¸€ä¸ªé€šçŸ¥</span></span><br><span class="line">   body: <span class="string">'æè¿°ä¿¡æ¯'</span>,</span><br><span class="line">   icon: <span class="string">'å›¾æ ‡åœ°å€'</span>,</span><br><span class="line">   requireInteraction: <span class="literal">true</span>, <span class="comment">// è¦æ±‚ç”¨æˆ·æœ‰äº¤äº’æ‰å…³é—­ï¼ˆå®æµ‹æ— æ•ˆï¼‰</span></span><br><span class="line">   data, <span class="comment">// å…¶ä»–æ•°æ®</span></span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// é€šçŸ¥æ¶ˆæ¯è¢«ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">notify.onclick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(notify.data)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>4.éšè—é¡¶éƒ¨èœå•æ </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Menu &#125; <span class="keyword">from</span> <span class="string">'electron'</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// éšè—é¡¶éƒ¨èœå•</span></span><br><span class="line"> Menu.setApplicationMenu(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure><h2 id="äº”ã€å‚è€ƒèµ„æ–™"><a href="#äº”ã€å‚è€ƒèµ„æ–™" class="headerlink" title="äº”ã€å‚è€ƒèµ„æ–™"></a>äº”ã€å‚è€ƒèµ„æ–™</h2><ul><li>electron å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://www.electronjs.org/docs" target="_blank" rel="noopener">https://www.electronjs.org/docs</a></li><li>electron-vue æ–‡æ¡£ï¼š<a href="https://simulatedgreg.gitbooks.io/electron-vue/content/cn/" target="_blank" rel="noopener">https://simulatedgreg.gitbooks.io/electron-vue/content/cn/</a></li><li>electronç³»ç»Ÿæ‰˜ç›˜åŠæ¶ˆæ¯é—ªåŠ¨æç¤ºï¼š<a href="https://juejin.im/post/6844903872905871373" target="_blank" rel="noopener">https://juejin.im/post/6844903872905871373</a></li></ul><p>ï¼ˆå®Œï¼‰</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;æœ€è¿‘å…¬å¸è®©æˆ‘å¼€å‘ä¸€ä¸ªæ¡Œé¢æŠ¥è­¦å™¨ï¼Œä»¥è§£å†³æµè§ˆå™¨é¡µé¢å…³é—­æ— æ³•æ’­æ”¾æŠ¥è­¦å£°éŸ³çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æ¥åˆ°è¿™ä¸ªé¡¹ç›®ï¼Œè‡ªç„¶çš„é€‰æ‹©äº† &lt;a href=&quot;https://simulatedgreg.gitbooks.io/electron-vue/content/
      
    
    </summary>
    
    
    
      <category term="electron" scheme="https://willxiao90.github.io/tags/electron/"/>
    
      <category term="electron-vue" scheme="https://willxiao90.github.io/tags/electron-vue/"/>
    
  </entry>
  
  <entry>
    <title>Vue ä¸ React çš„åŒºåˆ«</title>
    <link href="https://willxiao90.github.io/2020/06/29/Vue%20%E4%B8%8E%20React%20%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
    <id>https://willxiao90.github.io/2020/06/29/Vue%20%E4%B8%8E%20React%20%E7%9A%84%E5%8C%BA%E5%88%AB/</id>
    <published>2020-06-29T10:19:26.000Z</published>
    <updated>2024-07-21T02:38:05.765Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Vue ä¸ React æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p></blockquote><p>è¿™æ˜¯å‰ç«¯å¼€å‘åŒå­¦é¢è¯•æ—¶ç»å¸¸é‡åˆ°çš„é—®é¢˜ã€‚</p><p>æˆ‘æœ€å¼€å§‹æ¥è§¦çš„æ˜¯ Reactï¼Œå¯¹ Vue çš„ç†è§£ä¸€ç›´æ¯”è¾ƒç‰‡é¢ï¼Œæ„Ÿè§‰ Vue è¦å­¦å¾ˆå¤š html æŒ‡ä»¤ï¼Œå¾ˆä¸ä¹ æƒ¯ï¼Œä¹Ÿæ²¡è§‰å¾— Vue æ¯” React æœ‰ä»€ä¹ˆä¼˜åŠ¿ã€‚</p><p>ç›´åˆ°ç°åœ¨ï¼Œä½¿ç”¨äº† Vue ä¸€å¹´ä¹‹åï¼Œå¯¹ Vue æœ‰äº†æ›´å¤šæ„Ÿå—ï¼Œä¹Ÿæ¶ˆé™¤äº†ä¸€äº›åˆ»æ¿å°è±¡ã€‚</p><p>é¦–å…ˆï¼Œè¿™ä¸¤ä¸ªæ¡†æ¶éƒ½æ˜¯éå¸¸ä¼˜ç§€çš„ï¼Œå®ƒä»¬å…¶å®éå¸¸ç›¸ä¼¼ï¼Œéƒ½æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š</p><ol><li>å“åº”å¼ï¼ˆReactiveï¼‰ã€‚ä¸¤ä¸ªæ¡†æ¶éƒ½æ˜¯ä¸€ç§ç±»ä¼¼ VM çš„æ¶æ„ï¼Œå°†çŠ¶æ€ä»è§†å›¾å±‚åˆ†ç¦»å‡ºæ¥ï¼Œå¼€å‘è€…åªéœ€è¦å…³æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œä¸éœ€è¦ç›´æ¥æ“ä½œ DOM ã€‚å½“åº”ç”¨å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦æ›´æ–°çŠ¶æ€å³å¯ï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬é‡æ–°æ¸²æŸ“é¡µé¢ã€‚</li><li>ç»„ä»¶åŒ–ï¼ˆComposableï¼‰ã€‚ä¸€ä¸ªé¡µé¢ï¼Œå¯ä»¥æ‹†åˆ†æˆä¸€æ£µåµŒå¥—çš„ç»„ä»¶æ ‘ï¼Œæˆ‘ä»¬åªéœ€è¦å¼€å‘ä¸€ä¸ªä¸ªç»„ä»¶å³å¯ï¼ŒåŒä¸€ä¸ªç»„ä»¶å¯ä»¥åœ¨å¤šä¸ªåœ°æ–¹ä½¿ç”¨ï¼Œè¿™æ ·å°±æå‡äº†ä»£ç çš„å¤ç”¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</li><li>Virtual DOMã€‚æ¡†æ¶åœ¨æ“ä½œçœŸå® DOM ä¹‹å‰ï¼Œä¼šå…ˆåœ¨å†…å­˜ä¸­ç”Ÿæˆè™šæ‹Ÿ DOMï¼Œæœ€åå†æ‰¹é‡æ“ä½œçœŸå® DOMï¼Œä»¥æé«˜æ€§èƒ½ã€‚</li></ol><p>è‡³äºå®ƒä»¬çš„åŒºåˆ«ï¼Œæˆ‘ä¸ªäººç†è§£ï¼Œæœ€å¤§çš„æœ‰ä»¥ä¸‹ä¸‰ç‚¹ï¼š</p><ol><li>å“åº”å¼åŸç†ä¸åŒï¼›</li><li>Vue æ¨èä½¿ç”¨æ¨¡ç‰ˆçš„æ–¹å¼å®šä¹‰ç»„ä»¶ï¼ŒReact æ¨èä½¿ç”¨ JSXï¼›</li><li>React æ¨èä½¿ç”¨ä¸å¯å˜çš„æ•°æ®ï¼›</li></ol><p>å½“ç„¶å®ƒä»¬è‚¯å®šè¿˜æœ‰å…¶ä»–åŒºåˆ«ï¼Œæ¯”å¦‚ä»£ç å®ç°ã€çŠ¶æ€ç®¡ç†ç­‰ï¼Œä½†ä¸Šé¢è¿™ä¸‰ç‚¹æ˜¯å®ƒä»¬æ¯”è¾ƒå¤§çš„åŒºåˆ«ï¼Œæ˜¯æ¡†æ¶æœ‰æ„ä¸ºä¹‹çš„ï¼Œå¯¹æ—¥å¸¸çš„å¼€å‘å’Œç†è§£å½±å“ä¹Ÿæ˜¯æ¯”è¾ƒå¤§çš„ã€‚</p><h2 id="ä¸€ã€å“åº”å¼åŸç†ä¸åŒ"><a href="#ä¸€ã€å“åº”å¼åŸç†ä¸åŒ" class="headerlink" title="ä¸€ã€å“åº”å¼åŸç†ä¸åŒ"></a>ä¸€ã€å“åº”å¼åŸç†ä¸åŒ</h2><p>Vue ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼è‡ªåŠ¨è·Ÿè¸ªæ•°æ®çš„å˜åŒ–ï¼Œè‡ªåŠ¨æ›´æ–°ç»„ä»¶ã€‚</p><p>Vue ä¼šéå† data æ•°æ®å¯¹è±¡ï¼Œä½¿ç”¨ Object.defineProperty() å°†æ¯ä¸ªå±æ€§éƒ½è½¬æ¢ä¸º getter/setterã€‚æ¯ä¸ª Vue ç»„ä»¶å®ä¾‹éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„  watcher  å®ä¾‹ï¼Œåœ¨ç»„ä»¶åˆæ¬¡æ¸²æŸ“ï¼ˆrenderï¼‰æ—¶ï¼Œä¼šè®°å½•ç»„ä»¶ç”¨åˆ°äº†ï¼ˆè°ƒç”¨ getterï¼‰å“ªäº›æ•°æ®ã€‚å½“æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¼šè§¦å‘ setter æ–¹æ³•ï¼Œå¹¶é€šçŸ¥æ‰€æœ‰ä¾èµ–è¿™ä¸ªæ•°æ®çš„ watcher å®ä¾‹ï¼Œç„¶å watcher å®ä¾‹è°ƒç”¨å¯¹åº”ç»„ä»¶çš„ render æ–¹æ³•ï¼Œç”Ÿæˆä¸€é¢—æ–°çš„ vdom æ ‘ï¼ŒVue ä¼šå°†æ–°ç”Ÿæˆçš„ vdom æ ‘ä¸ä¸Šä¸€æ¬¡ç”Ÿæˆçš„ vdom æ ‘è¿›è¡Œæ¯”è¾ƒï¼ˆdiffï¼‰ï¼Œæ¥å†³å®šå…·ä½“è¦æ›´æ–°å“ªäº› domã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6af41181deba4e40b4dcd1667cce42fd~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><hr><p>React å¿…é¡»æ˜¾å¼è°ƒç”¨ setState() æ–¹æ³•æ›´æ–°çŠ¶æ€ï¼ŒçŠ¶æ€æ›´æ–°ä¹‹åï¼Œç»„ä»¶ä¹Ÿä¼šé‡æ–°æ¸²æŸ“ã€‚</p><p>Vue å’Œ React åœ¨çŠ¶æ€æ›´æ–°ä¹‹åï¼Œéƒ½ä¼šç”Ÿæˆä¸€é¢—æ–°çš„è™šæ‹Ÿ dom æ ‘ï¼Œä¸ä¸Šä¸€é¢—è™šæ‹Ÿ dom æ ‘è¿›è¡Œæ¯”è¾ƒï¼ˆdiffï¼‰ï¼Œæ‰¾å‡ºå…¶ä¸­çš„å·®å¼‚ï¼Œå†æ›´æ–°çœŸå® domã€‚è¿™ä¸ªè™šæ‹Ÿ dom diff ç®—æ³•ï¼ŒVue ä¸ React å·®å¼‚å…¶å®å¹¶ä¸å¤§ï¼ŒåŸºæœ¬æ€æƒ³æ˜¯å·®ä¸å¤šçš„ã€‚å¤§å®¶å¯ä»¥çœ‹çœ‹ç½‘ä¸Šçš„æ–‡ç« ï¼Œæˆ‘è¿™é‡Œå°±ä¸å±•å¼€äº†ã€‚</p><h2 id="äºŒã€Vue-æ¨èä½¿ç”¨-template-å®šä¹‰ç»„ä»¶ï¼ŒReact-æ¨èä½¿ç”¨-JSX"><a href="#äºŒã€Vue-æ¨èä½¿ç”¨-template-å®šä¹‰ç»„ä»¶ï¼ŒReact-æ¨èä½¿ç”¨-JSX" class="headerlink" title="äºŒã€Vue æ¨èä½¿ç”¨ template å®šä¹‰ç»„ä»¶ï¼ŒReact æ¨èä½¿ç”¨ JSX"></a>äºŒã€Vue æ¨èä½¿ç”¨ template å®šä¹‰ç»„ä»¶ï¼ŒReact æ¨èä½¿ç”¨ JSX</h2><p>Vue æ¨èä½¿ç”¨ template çš„æ–¹å¼å®šä¹‰ç»„ä»¶ï¼Œå› ä¸ºè¿™æ ·æ›´æ¥è¿‘åŸç”Ÿ htmlï¼Œå¯ä»¥åœ¨ä¸ç ´ååŸæœ‰ html ä»£ç çš„åŸºç¡€ä¸Šå¼•å…¥ Vue çš„èƒ½åŠ›ã€‚Vue çš„ç»„ä»¶ä¹Ÿå‚è€ƒäº†ä¸€äº› Web Component çš„è§„èŒƒï¼ŒVue çš„ç»„ä»¶å¯ä»¥å¾ˆå®¹æ˜“æ‰“åŒ…æˆ Web Componentã€‚</p><p>React æ¨èä½¿ç”¨ JSXï¼ŒJSX æ˜¯ä½¿ç”¨ JS çš„è¯­æ³•æ¥ç¼–å†™ html ä»£ç ï¼Œæ‰€ä»¥ä¸€äº›æµç¨‹æ§åˆ¶ï¼Œæ•°æ®ç»‘å®šä¹Ÿä¼šæ›´åŠ æ–¹ä¾¿ã€‚ä¹Ÿä¸éœ€è¦å†å­¦ä¸€å¥—æ¨¡æ¿è¯­æ³•ã€‚</p><p>äº‹å®ä¸Š Vue ä¹Ÿæä¾›äº† JSX çš„æ”¯æŒï¼Œä¸è¿‡ Vue æ›´æ¨è template çš„æ–¹å¼ã€‚</p><h2 id="ä¸‰ã€React-æ¨èä½¿ç”¨ä¸å¯å˜çš„æ•°æ®"><a href="#ä¸‰ã€React-æ¨èä½¿ç”¨ä¸å¯å˜çš„æ•°æ®" class="headerlink" title="ä¸‰ã€React æ¨èä½¿ç”¨ä¸å¯å˜çš„æ•°æ®"></a>ä¸‰ã€React æ¨èä½¿ç”¨ä¸å¯å˜çš„æ•°æ®</h2><p>è¿™ä¸€ç‚¹å¯¹äºä» Vue è½¬æ¢åˆ° React çš„åŒå­¦ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ã€‚</p><p>æ‰€è°“ä¸å¯å˜çš„æ•°æ®ï¼Œå°±æ˜¯å½“æˆ‘ä»¬è¦æ”¹å˜ä¸€ä¸ªæ•°æ®å¯¹è±¡æ—¶ï¼Œä¸è¦ç›´æ¥ä¿®æ”¹åŸæ•°æ®å¯¹è±¡ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°çš„æ•°æ®å¯¹è±¡ã€‚æ¯”å¦‚ä½¿ç”¨ Object.assign() æ–¹æ³•ä¿®æ”¹æ•°æ®å±æ€§:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = &#123;</span><br><span class="line">  fontSize: <span class="number">14</span>,</span><br><span class="line">  color: <span class="string">"black"</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> newData = <span class="built_in">Object</span>.assign(&#123;&#125;, data, &#123; <span class="attr">color</span>: <span class="string">"blue"</span> &#125;);</span><br></pre></td></tr></table></figure><p>ä¹‹æ‰€ä»¥æ¨èä½¿ç”¨ä¸å¯å˜çš„æ•°æ®ï¼Œä¸€ä¸ªåŸå› æ˜¯ä½¿ç”¨ä¸å¯å˜çš„æ•°æ®ï¼Œå¯ä»¥æ›´å®¹æ˜“çš„å®ç°â€œæ—¶é—´æ—…è¡Œâ€åŠŸèƒ½ã€‚ä½†æ˜¯æ›´é‡è¦çš„ä¸€ä¸ªåŸå› æ˜¯å¯ä»¥æ›´å®¹æ˜“çš„å®ç° pure componentã€‚</p><p>å½“ä¸€ä¸ªç»„ä»¶çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒReact ä¼šé‡æ–°è°ƒç”¨ render() æ–¹æ³•ï¼Œæ¯”è¾ƒç”Ÿæˆçš„ VDOM çš„å·®åˆ«ã€‚å¦‚æœä¸€ä¸ªå­ç»„ä»¶çš„ proos å’Œ state éƒ½æ²¡æœ‰æ”¹å˜ï¼ŒReact ä»ç„¶éœ€è¦è¿›è¡Œä¸€æ¬¡å¯¹æ¯”ï¼Œè¿™ä¸ªæƒ…å†µå°±æœ‰ç‚¹å„¿æµªè´¹äº†ã€‚æ‰€ä»¥ React æä¾›äº† shouldComponentUpdate() ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œå…è®¸å¼€å‘è€…åˆ¤æ–­ä»€ä¹ˆæ—¶å€™åº”è¯¥æ›´æ–°ç»„ä»¶ï¼Œæ¯”å¦‚å½“ç»„ä»¶çš„ props å’Œ state éƒ½æ²¡æœ‰æ”¹å˜çš„æ—¶å€™ï¼ŒshouldComponentUpdate å°±å¯ä»¥è¿”å› falseï¼Œé‚£ä¹ˆ React å°±ä¸ä¼šå†å»æ¯”è¾ƒ VDOM çš„å·®å¼‚äº†ã€‚</p><p>React.PureComponent ç±»ï¼Œå®ç°äº† shouldComponentUpdate æ–¹æ³•ï¼Œä¼šå¯¹ props å’Œ state è¿›è¡Œæµ…æ¯”è¾ƒï¼Œå¦‚æœæ²¡æœ‰å˜åŒ–ï¼Œå°±è¿”å› false è·³è¿‡ç»„ä»¶æ›´æ–°ã€‚ä½†æ˜¯å®ƒåªè¿›è¡Œæµ…æ¯”è¾ƒï¼Œæ‰€ä»¥å¦‚æœç›´æ¥ä¿®æ”¹äº† props æˆ– state çš„å±æ€§ï¼ŒshouldComponentUpdate æ–¹æ³•è¿˜æ˜¯è¿”å› falseï¼Œå°±æ¼æ‰äº†è¿™æ¬¡æ›´æ–°ã€‚æ‰€ä»¥è¿™ç§æƒ…å†µä¸‹ï¼Œæ¨èä½¿ç”¨ä¸å¯å˜çš„æ•°æ®ã€‚</p><p>æ›´å¤šä¿¡æ¯è¯·çœ‹å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://zh-hans.reactjs.org/tutorial/tutorial.html#why-immutability-is-important" target="_blank" rel="noopener">ä¸ºä»€ä¹ˆä¸å¯å˜æ€§åœ¨ React ä¸­éå¸¸é‡è¦</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;Vue ä¸ React æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™æ˜¯å‰ç«¯å¼€å‘åŒå­¦é¢è¯•æ—¶ç»å¸¸é‡åˆ°çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘æœ€å¼€å§‹æ¥è§¦çš„æ˜¯ Reactï¼Œå¯¹ Vue çš„ç†è§£ä¸€ç›´æ¯”è¾ƒç‰‡é¢ï¼Œæ„Ÿè§‰ Vue è¦å­¦å¾ˆå¤š html æŒ‡ä»¤ï¼Œå¾ˆä¸ä¹ æƒ¯ï¼Œä¹Ÿ
      
    
    </summary>
    
    
    
      <category term="vue" scheme="https://willxiao90.github.io/tags/vue/"/>
    
      <category term="react" scheme="https://willxiao90.github.io/tags/react/"/>
    
  </entry>
  
</feed>
