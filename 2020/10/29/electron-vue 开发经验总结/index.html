<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>electron-vue å¼€å‘ç»éªŒæ€»ç»“ | Will Xiao | åˆ†äº«æ˜¯æœ€å¥½çš„å­¦ä¹ </title>

  
  <meta name="author" content="Will Xiao">
  

  
  <meta name="description" content="ä¸ªäººåšå®¢">
  

  
  <meta name="keywords" content="willxiao, åšå®¢">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="electron-vue å¼€å‘ç»éªŒæ€»ç»“"/>

  <meta property="og:site_name" content="Will Xiao"/>

  
  <meta property="og:image" content="/blog/favicon.ico"/>
  

  <link href="/blog/favicon.ico" rel="icon">
  <link rel="alternate" href="/blog/atom.xml" title="Will Xiao" type="application/atom+xml">
  <link rel="stylesheet" href="/blog/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 4.2.1"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/blog/">Will Xiao</a>
    </h1>
    <p class="site-description">åˆ†äº«æ˜¯æœ€å¥½çš„å­¦ä¹ </p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/blog/">ä¸»é¡µ</a></li>
      
        <li><a href="/blog/archives">å½’æ¡£</a></li>
      
        <li><a href="/blog/about">å…³äº</a></li>
      
        <li><a href="/blog/atom.xml">è®¢é˜…</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>electron-vue å¼€å‘ç»éªŒæ€»ç»“</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/blog/2020/10/29/electron-vue å¼€å‘ç»éªŒæ€»ç»“/" rel="bookmark">
        <time class="entry-date published" datetime="2020-10-29T18:14:15.000Z">
          2020-10-29
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <blockquote>
<p>æœ€è¿‘å…¬å¸è®©æˆ‘å¼€å‘ä¸€ä¸ªæ¡Œé¢æŠ¥è­¦å™¨ï¼Œä»¥è§£å†³æµè§ˆå™¨é¡µé¢å…³é—­æ— æ³•æ’­æ”¾æŠ¥è­¦å£°éŸ³çš„é—®é¢˜ã€‚</p>
<p>æ¥åˆ°è¿™ä¸ªé¡¹ç›®ï¼Œè‡ªç„¶çš„é€‰æ‹©äº† <a href="https://simulatedgreg.gitbooks.io/electron-vue/content/cn/" target="_blank" rel="noopener">electron-vue</a> è¿›è¡Œå¼€å‘ï¼ˆæˆ‘ä»¬å…¬å¸ä½¿ç”¨çš„ vueï¼‰</p>
<p>ç°åœ¨æœ‰æ—¶é—´äº†ï¼Œå¯¹é¡¹ç›®ä¸­é‡åˆ°çš„é—®é¢˜è¿›è¡Œä¸€ä¸ªæ€»ç»“ã€‚</p>
</blockquote>
<h2 id="ä¸€ã€é¡¹ç›®æ­å»º-amp-æ‰“åŒ…"><a href="#ä¸€ã€é¡¹ç›®æ­å»º-amp-æ‰“åŒ…" class="headerlink" title="ä¸€ã€é¡¹ç›®æ­å»º &amp; æ‰“åŒ…"></a>ä¸€ã€é¡¹ç›®æ­å»º &amp; æ‰“åŒ…</h2><p>é¡¹ç›®æ­å»ºæ¯”è¾ƒç®€å•ï¼Œç›´æ¥ä½¿ç”¨ electron-vue çš„å®˜æ–¹æ¨¡æ¿å°±å¯ä»¥ç”Ÿæˆé¡¹ç›®ï¼Œéœ€è¦å®‰è£… vue-cli å‘½ä»¤è¡Œå·¥å…·ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install -g vue-cli &#x2F;&#x2F; éœ€è¦å®‰è£… vue-cli è„šæ‰‹æ¶</span><br><span class="line">vue init simulatedgreg&#x2F;electron-vue project-name &#x2F;&#x2F; ä½¿ç”¨ electron-vue å®˜æ–¹æ¨¡æ¿ç”Ÿæˆé¡¹ç›®</span><br><span class="line">npm install &#x2F;&#x2F; å®‰è£…ä¾èµ–</span><br><span class="line">npm run dev &#x2F;&#x2F; å¯åŠ¨é¡¹ç›®</span><br></pre></td></tr></table></figure>

<p>é¡¹ç›®æ‰“åŒ…ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå¯èƒ½ä¹Ÿæ˜¯å› ä¸ºæˆ‘çš„é¡¹ç›®æœ¬èº«ä¸å¤æ‚å§ã€‚æ™®é€šæ‰“åŒ…æ‰§è¡Œ npm run build å³å¯ï¼Œå¦‚æœè¦æ‰“åŒ…æˆå…å®‰è£…æ–‡ä»¶ï¼Œæ‰§è¡Œ npm run build:dirï¼Œéå¸¸æ–¹ä¾¿ï¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm run build &#x2F;&#x2F; æ‰“åŒ…æˆå¯æ‰§è¡Œæ–‡ä»¶</span><br><span class="line">npm run build:dir &#x2F;&#x2F; æ‰“åŒ…æˆå…å®‰è£…æ–‡ä»¶</span><br></pre></td></tr></table></figure>

<h2 id="äºŒã€çŠ¶æ€ç®¡ç†"><a href="#äºŒã€çŠ¶æ€ç®¡ç†" class="headerlink" title="äºŒã€çŠ¶æ€ç®¡ç†"></a>äºŒã€çŠ¶æ€ç®¡ç†</h2><p>å› ä¸º electron æ¯ä¸ªç½‘é¡µéƒ½åœ¨è‡ªå·±çš„æ¸²æŸ“è¿›ç¨‹ï¼ˆrenderer processï¼‰ä¸­è¿è¡Œï¼Œæ‰€ä»¥å¦‚æœè¦åœ¨å¤šä¸ªæ¸²æŸ“è¿›ç¨‹é—´å…±äº«çŠ¶æ€ï¼Œå°±ä¸èƒ½ç›´æ¥ä½¿ç”¨ vuex äº†ã€‚</p>
<p><a href="https://github.com/vue-electron/vuex-electron" target="_blank" rel="noopener">vuex-electron</a> è¿™ä¸ªå¼€æºåº“ä¸ºæˆ‘ä»¬æä¾›äº†ï¼Œåœ¨å¤šä¸ªè¿›ç¨‹é—´å…±äº«çŠ¶æ€çš„æ–¹æ¡ˆï¼ˆåŒ…æ‹¬ä¸»è¿›ç¨‹ï¼‰ã€‚</p>
<p>å¦‚æœéœ€è¦åœ¨å¤šä¸ªè¿›ç¨‹é—´å…±äº«çŠ¶æ€ï¼Œéœ€è¦ä½¿ç”¨ createSharedMutations ä¸­é—´ä»¶ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store.js æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">"vue"</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">"vuex"</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> &#123; createPersistedState, createSharedMutations &#125; <span class="keyword">from</span> <span class="string">"vuex-electron"</span></span><br><span class="line"> </span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  plugins: [</span><br><span class="line">    createPersistedState(),</span><br><span class="line">    createSharedMutations() <span class="comment">// ç”¨äºå¤šä¸ªè¿›ç¨‹å…±äº«çŠ¶æ€ï¼ŒåŒ…æ‹¬ä¸»è¿›ç¨‹</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>å¹¶åœ¨ä¸»è¿›ç¨‹ä¸­å¼•å…¥ store æ–‡ä»¶ã€‚è¿™é‡Œæœ‰ç‚¹å‘ï¼Œæœ€å¼€å§‹çš„æ—¶å€™æˆ‘ä¸çŸ¥é“è¦åœ¨ main.js ä¸­å¼•å…¥ store æ–‡ä»¶ï¼Œç»“æœçŠ¶æ€ä¸€ç›´æ— æ³•æ›´æ–°ï¼Œåˆæ²¡æœ‰ä»»ä½•æŠ¥é”™ï¼Œè°ƒè¯•äº†ä¸€ä¸‹åˆğŸ˜“</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./path/to/your/store'</span> <span class="comment">// éœ€è¦åœ¨ä¸»è¿›ç¨‹å¼•å…¥ store ï¼Œå¦åˆ™çŠ¶æ€æ— æ³•æ›´æ–°</span></span><br></pre></td></tr></table></figure>

<p>å¦å¤–ï¼Œä½¿ç”¨ createSharedMutations ä¸­é—´ä»¶ï¼Œå¿…é¡»ä½¿ç”¨ dispatch æˆ– mapActions æ›´æ–°çŠ¶æ€ï¼Œä¸èƒ½ä½¿ç”¨ commit ã€‚</p>
<p>é˜…è¯» vuex-electron çš„æºä»£ç ï¼Œå‘ç°æ¸²æŸ“è¿›ç¨‹å¯¹ dispatch è¿›è¡Œäº†é‡å†™ï¼Œdispatch åªæ˜¯é€šçŸ¥ä¸»è¿›ç¨‹ï¼Œè€Œä¸å®é™…æ›´æ–° storeï¼Œä¸»è¿›ç¨‹æ”¶åˆ° action ä¹‹åï¼Œç«‹å³æ›´æ–°è‡ªå·±çš„ storeï¼Œä¸»è¿›ç¨‹ store æ›´æ–°æˆåŠŸä¹‹åï¼Œä¼šé€šçŸ¥æ‰€æœ‰çš„æ¸²æŸ“è¿›ç¨‹ï¼Œè¿™ä¸ªæ—¶å€™æ¸²æŸ“è¿›ç¨‹æ‰è°ƒç”¨ originalCommit æ›´æ–°è‡ªå·±çš„ storeã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">rendererProcessLogic() &#123;</span><br><span class="line">    <span class="comment">// Connect renderer to main process</span></span><br><span class="line">    <span class="keyword">this</span>.connect()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Save original Vuex methods</span></span><br><span class="line">    <span class="keyword">this</span>.store.originalCommit = <span class="keyword">this</span>.store.commit</span><br><span class="line">    <span class="keyword">this</span>.store.originalDispatch = <span class="keyword">this</span>.store.dispatch</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Don't use commit in renderer outside of actions</span></span><br><span class="line">    <span class="keyword">this</span>.store.commit = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">`[Vuex Electron] Please, don't use direct commit's, use dispatch instead of this.`</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Forward dispatch to main process</span></span><br><span class="line">    <span class="keyword">this</span>.store.dispatch = <span class="function">(<span class="params">type, payload</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// åªæ˜¯é€šçŸ¥ä¸»è¿›ç¨‹ï¼Œæ²¡æœ‰æ›´æ–° store</span></span><br><span class="line">        <span class="keyword">this</span>.notifyMain(&#123; type, payload &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Subscribe on changes from main process and apply them</span></span><br><span class="line">    <span class="keyword">this</span>.onNotifyRenderers(<span class="function">(<span class="params">event, &#123; type, payload &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// æ¸²æŸ“è¿›ç¨‹çœŸæ­£æ›´æ–°è‡ªå·±çš„ store</span></span><br><span class="line">        <span class="keyword">this</span>.store.originalCommit(type, payload)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ... çœç•¥å…¶ä»–ä»£ç </span></span><br><span class="line"></span><br><span class="line">mainProcessLogic() &#123;</span><br><span class="line">    <span class="keyword">const</span> connections = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Save new connection</span></span><br><span class="line">    <span class="keyword">this</span>.onConnect(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> win = event.sender</span><br><span class="line">        <span class="keyword">const</span> winId = win.id</span><br><span class="line"></span><br><span class="line">        connections[winId] = win</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Remove connection when window is closed</span></span><br><span class="line">        win.on(<span class="string">"destroyed"</span>, () =&gt; &#123;</span><br><span class="line">        <span class="keyword">delete</span> connections[winId]</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Subscribe on changes from renderer processes</span></span><br><span class="line">    <span class="keyword">this</span>.onNotifyMain(<span class="function">(<span class="params">event, &#123; type, payload &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// ä¸»è¿›ç¨‹æ›´æ–°äº†è‡ªå·±çš„ store</span></span><br><span class="line">        <span class="keyword">this</span>.store.dispatch(type, payload)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Subscribe on changes from Vuex store</span></span><br><span class="line">    <span class="keyword">this</span>.store.subscribe(<span class="function">(<span class="params">mutation</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; type, payload &#125; = mutation</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¸»è¿›ç¨‹æ›´æ–°æˆåŠŸä¹‹åï¼Œé€šçŸ¥æ‰€æœ‰æ¸²æŸ“è¿›ç¨‹</span></span><br><span class="line">        <span class="keyword">this</span>.notifyRenderers(connections, &#123; type, payload &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œæ¸²æŸ“è¿›ç¨‹çœŸæ­£æ›´æ–° store ç”¨çš„ originalCommit æ–¹æ³•ï¼Œè€Œä¸æ˜¯ originalDispatch æ–¹æ³•ï¼Œå…¶å® originalDispatch åªæ˜¯ä¸ªä»£ç†ï¼Œæ¯ä¸€ä¸ª mutations éƒ½éœ€è¦å†™ä¸€ä¸ªåŒåçš„ actions æ–¹æ³•ï¼Œæ¥æ”¶ç›¸åŒçš„å‚æ•°ï¼Œå¦‚ä¸‹é¢çš„å®˜æ–¹æ ·ä¾‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">"vue"</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">"vuex"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; createPersistedState, createSharedMutations &#125; <span class="keyword">from</span> <span class="string">"vuex-electron"</span></span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    count: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  actions: &#123;</span><br><span class="line">    increment(store) &#123;</span><br><span class="line">      <span class="comment">// æŒ‰ç…§æ¨ç†ï¼Œè¿™é‡Œçš„ commit å…¶å®ä¸èµ·ä½œç”¨ï¼Œä¸æ˜¯å¿…é¡»</span></span><br><span class="line">      <span class="comment">// å…³é”®æ˜¯åç§°ç›¸åŒ</span></span><br><span class="line">      store.commit(<span class="string">"increment"</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    decrement(store) &#123;</span><br><span class="line">      store.commit(<span class="string">"decrement"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  mutations: &#123;</span><br><span class="line">    increment(state) &#123;</span><br><span class="line">      state.count++</span><br><span class="line">    &#125;,</span><br><span class="line">    decrement(state) &#123;</span><br><span class="line">      state.count--</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  plugins: [createPersistedState(), createSharedMutations()],</span><br><span class="line">  strict: process.env.NODE_ENV !== <span class="string">"production"</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>äº‹å®ä¸Šï¼Œå¦‚æœåº”ç”¨å¾ˆç®€å•ï¼Œæ¯”å¦‚æˆ‘çš„é¡¹ç›®åªæœ‰ä¸€ä¸ªçª—å£ï¼Œå°±ä¸å­˜åœ¨å…±äº«çŠ¶æ€çš„é—®é¢˜ï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥ä¸ç”¨ createSharedMutations ä¸­é—´ä»¶ï¼Œä¹Ÿä¸ç”¨åœ¨ main.js ä¸­å¼•å…¥ store æ–‡ä»¶ï¼Œstore æ‰€æœ‰ç”¨æ³•å°±è·Ÿ vuex ä¸€æ ·äº†ã€‚</p>
<h2 id="ä¸‰ã€æ—¥å¿—"><a href="#ä¸‰ã€æ—¥å¿—" class="headerlink" title="ä¸‰ã€æ—¥å¿—"></a>ä¸‰ã€æ—¥å¿—</h2><p>æ—¥å¿—æˆ‘é‡‡ç”¨çš„æ˜¯ <a href="https://github.com/megahertz/electron-log" target="_blank" rel="noopener">electron-log</a>ï¼Œä¹Ÿå¯ä»¥ç”¨ <a href="https://github.com/log4js-node/log4js-node" target="_blank" rel="noopener">log4js</a></p>
<p>åœ¨ä¸»è¿›ç¨‹ä¸­ä½¿ç”¨ electron-log å¾ˆç®€å•ï¼Œç›´æ¥å¼•å…¥ï¼Œè°ƒç”¨ info ç­‰æ–¹æ³•å³å¯ã€‚<br>electron-log æä¾›äº† error, warn, info, verbose, debug, silly å…­ç§çº§åˆ«çš„æ—¥å¿—ï¼Œé»˜è®¤éƒ½æ˜¯å¼€å¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> log <span class="keyword">from</span> <span class="string">'electron-log'</span>;</span><br><span class="line"> </span><br><span class="line">log.info(<span class="string">'client å¯åŠ¨æˆåŠŸ'</span>);</span><br><span class="line">log.error(<span class="string">'ä¸»è¿›ç¨‹å‡ºé”™'</span>);</span><br></pre></td></tr></table></figure>

<p>åœ¨æ¸²æŸ“è¿›ç¨‹ä½¿ç”¨ electron-logï¼Œå¯ä»¥è¦†ç›– console.log ç­‰æ–¹æ³•ï¼Œè¿™æ ·å°±ä¸ç”¨åˆ°å¤„å¼•å…¥ electron-log äº†ï¼Œéœ€è¦å†™æ—¥å¿—çš„åœ°æ–¹ç›´æ¥ä½¿ç”¨ console.log ç­‰æ–¹æ³•å³å¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> log <span class="keyword">from</span> <span class="string">'electron-log'</span>;</span><br><span class="line"> </span><br><span class="line"> <span class="comment">// è¦†ç›– console çš„ logã€errorã€debug ä¸‰ä¸ªæ–¹æ³•</span></span><br><span class="line"><span class="built_in">console</span>.log = log.log;</span><br><span class="line"><span class="built_in">Object</span>.assign(<span class="built_in">console</span>, &#123;</span><br><span class="line">  error: log.error,</span><br><span class="line">  debug: log.debug,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¹‹åï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ console æ”¶é›†æ—¥å¿—</span></span><br><span class="line"><span class="built_in">console</span>.error(<span class="string">'æ¸²æŸ“è¿›ç¨‹å‡ºé”™'</span>)</span><br></pre></td></tr></table></figure>

<p>electron-log é»˜è®¤ä¼šæ‰“å°åˆ° console æ§åˆ¶å°ï¼Œå¹¶å†™å…¥åˆ°æœ¬åœ°æ–‡ä»¶ï¼Œæœ¬åœ°æ–‡ä»¶è·¯å¾„å¦‚ä¸‹ï¼š</p>
<ul>
<li>on Linux: ~/.config/{app name}/logs/{process type}.log</li>
<li>on macOS: ~/Library/Logs/{app name}/{process type}.log</li>
<li>on Windows: %USERPROFILE%\AppData\Roaming{app name}\logs{process type}.log</li>
</ul>
<hr>
<p>å¦‚æœä½¿ç”¨ log4js çš„è¯ï¼Œé…ç½®ç›¸å¯¹å¤æ‚ä¸€ç‚¹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æ–‡ä»¶ä¸èƒ½ç›´æ¥å†™åˆ°å½“å‰ç›®å½•ï¼Œè€Œæ˜¯è¦ä½¿ç”¨ app.getPath(â€˜logsâ€™) è·å–åº”ç”¨ç¨‹åºæ—¥å¿—æ–‡ä»¶å¤¹è·¯å¾„ï¼Œå¦åˆ™æ‰“åŒ…ä¹‹åæ— æ³•ç”Ÿæˆæ—¥å¿—æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> log4js <span class="keyword">from</span> <span class="string">'log4js'</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šè¿™é‡Œå¿…é¡»ä½¿ç”¨ app.getPath('logs') è·å–æ—¥å¿—æ–‡ä»¶å¤¹è·¯å¾„</span></span><br><span class="line">log4js.configure(&#123;</span><br><span class="line">  appenders: &#123; <span class="attr">cheese</span>: &#123; <span class="attr">type</span>: <span class="string">'file'</span>, <span class="attr">filename</span>: app.getPath(<span class="string">'logs'</span>) + <span class="string">'/cheese.log'</span> &#125; &#125;,</span><br><span class="line">  categories: &#123; <span class="attr">default</span>: &#123; <span class="attr">appenders</span>: [<span class="string">'cheese'</span>], <span class="attr">level</span>: <span class="string">'error'</span> &#125; &#125;</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> logger = log4js.getLogger(<span class="string">'cheese'</span>)</span><br><span class="line">logger.trace(<span class="string">'Entering cheese testing'</span>)</span><br><span class="line">logger.debug(<span class="string">'Got cheese.'</span>)</span><br><span class="line">logger.info(<span class="string">'Cheese is ComtÃ©.'</span>)</span><br><span class="line">logger.warn(<span class="string">'Cheese is quite smelly.'</span>)</span><br><span class="line">logger.error(<span class="string">'Cheese is too ripe!'</span>)</span><br><span class="line">logger.fatal(<span class="string">'Cheese was breeding ground for listeria.'</span>)</span><br></pre></td></tr></table></figure>

<h2 id="å››ã€å…¶ä»–é—®é¢˜"><a href="#å››ã€å…¶ä»–é—®é¢˜" class="headerlink" title="å››ã€å…¶ä»–é—®é¢˜"></a>å››ã€å…¶ä»–é—®é¢˜</h2><p>1.ä¿®æ”¹ç³»ç»Ÿæ‰˜ç›˜å›¾æ ‡ï¼Œä¸‹é¢ä»£ç å‚è€ƒäº†ï¼š<a href="https://juejin.im/post/6844903872905871373" target="_blank" rel="noopener">https://juejin.im/post/6844903872905871373</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> tray;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createTray</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> iconUrl = path.join(__static, <span class="string">'/app-icon.png'</span>);</span><br><span class="line">  <span class="keyword">const</span> appIcon = nativeImage.createFromPath(iconUrl);</span><br><span class="line">  tray = <span class="keyword">new</span> Tray(appIcon);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">const</span> contextMenu = Menu.buildFromTemplate([</span><br><span class="line">    &#123;</span><br><span class="line">      label: <span class="string">'æ˜¾ç¤ºä¸»ç•Œé¢'</span>,</span><br><span class="line">      click: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (mainWindow) &#123;</span><br><span class="line">          mainWindow.show();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123; <span class="attr">label</span>: <span class="string">'é€€å‡ºç¨‹åº'</span>, <span class="attr">role</span>: <span class="string">'quit'</span> &#125;,</span><br><span class="line">  ]);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">const</span> appName = app.getName();</span><br><span class="line">  tray.setToolTip(appName);</span><br><span class="line">  tray.setContextMenu(contextMenu);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">let</span> timer;</span><br><span class="line">  <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">  ipcMain.on(<span class="string">'newMessage'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="comment">// å›¾æ ‡é—ªçƒ</span></span><br><span class="line">    timer = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      count += <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> (count % <span class="number">2</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        tray.setImage(appIcon);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªç©ºçš„ nativeImage å®ä¾‹</span></span><br><span class="line">        tray.setImage(nativeImage.createEmpty());</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">500</span>);</span><br><span class="line">      tray.setToolTip(<span class="string">'æ‚¨æœ‰ä¸€æ¡æ–°æ¶ˆæ¯'</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"> </span><br><span class="line">  tray.on(<span class="string">'click'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (mainWindow) &#123;</span><br><span class="line">      mainWindow.show();</span><br><span class="line">      <span class="keyword">if</span> (timer) &#123;</span><br><span class="line">        clearInterval(timer);</span><br><span class="line">        tray.setImage(appIcon);</span><br><span class="line">        tray.setToolTip(appName);</span><br><span class="line">        timer = <span class="literal">undefined</span>;</span><br><span class="line">        count = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2.æ’­æ”¾å£°éŸ³</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">audio = <span class="keyword">new</span> Audio(<span class="string">'static/alarm.wav'</span>);</span><br><span class="line">audio.play(); <span class="comment">// å¼€å§‹æ’­æ”¾</span></span><br><span class="line">audio.pause(); <span class="comment">// æš‚åœ</span></span><br></pre></td></tr></table></figure>

<p>3.æ˜¾ç¤ºé€šçŸ¥æ¶ˆæ¯</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> notify = <span class="keyword">new</span> Notification(<span class="string">'æ ‡é¢˜'</span>, &#123;</span><br><span class="line">   tag: <span class="string">'å”¯ä¸€æ ‡è¯†'</span>, <span class="comment">// ç›¸åŒ tag åªä¼šæ˜¾ç¤ºä¸€ä¸ªé€šçŸ¥</span></span><br><span class="line">   body: <span class="string">'æè¿°ä¿¡æ¯'</span>,</span><br><span class="line">   icon: <span class="string">'å›¾æ ‡åœ°å€'</span>,</span><br><span class="line">   requireInteraction: <span class="literal">true</span>, <span class="comment">// è¦æ±‚ç”¨æˆ·æœ‰äº¤äº’æ‰å…³é—­ï¼ˆå®æµ‹æ— æ•ˆï¼‰</span></span><br><span class="line">   data, <span class="comment">// å…¶ä»–æ•°æ®</span></span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// é€šçŸ¥æ¶ˆæ¯è¢«ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">notify.onclick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(notify.data)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>4.éšè—é¡¶éƒ¨èœå•æ </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Menu &#125; <span class="keyword">from</span> <span class="string">'electron'</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// éšè—é¡¶éƒ¨èœå•</span></span><br><span class="line"> Menu.setApplicationMenu(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€å‚è€ƒèµ„æ–™"><a href="#äº”ã€å‚è€ƒèµ„æ–™" class="headerlink" title="äº”ã€å‚è€ƒèµ„æ–™"></a>äº”ã€å‚è€ƒèµ„æ–™</h2><ul>
<li>electron å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://www.electronjs.org/docs" target="_blank" rel="noopener">https://www.electronjs.org/docs</a></li>
<li>electron-vue æ–‡æ¡£ï¼š<a href="https://simulatedgreg.gitbooks.io/electron-vue/content/cn/" target="_blank" rel="noopener">https://simulatedgreg.gitbooks.io/electron-vue/content/cn/</a></li>
<li>electronç³»ç»Ÿæ‰˜ç›˜åŠæ¶ˆæ¯é—ªåŠ¨æç¤ºï¼š<a href="https://juejin.im/post/6844903872905871373" target="_blank" rel="noopener">https://juejin.im/post/6844903872905871373</a></li>
</ul>
<p>ï¼ˆå®Œï¼‰</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/blog/tags/electron/">electron</a><a href="/blog/tags/electron-vue/">electron-vue</a>
    </span>
    

    </div>

    
  </div>
</article>

  
	<section id="comment" class="comment">
		<div id="gitalk-container"></div>
	</section>
	<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
	<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
	<script>
		var gitalk = new Gitalk({
			clientID: '4421bfda8e8d375deae4',
			clientSecret: 'a7f979b31ff68c0b8309e9e0d55991576bdb4a99',
			repo: 'blog',
			owner: 'willxiao90',
			admin: ['willxiao90'],
			id: decodeURIComponent(location.pathname).substring(0, 50), // è§£å†³ id é•¿åº¦é™åˆ¶ 50 ä¸ªå­—ç¬¦é—®é¢˜
			distractionFreeMode: false
		})

		gitalk.render('gitalk-container')
	</script>







    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2021 Will Xiao
    
  </p>
</footer>
    
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-169332409-1', 'auto');
    ga('send', 'pageview');

</script>

  </div>
</div>
</body>
</html>